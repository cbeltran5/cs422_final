<!-- template for Project 1 - CS 422 - Spring 2016 - Andrew Johnson -->

<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>CS 422 Project 2. Door-é-mi</title>

    <style>
      code {
        background: #1D5F9A;
        border-radius: 6px;
        color: #fff;
        display: block;
        font: 40px/40px "Source Code Pro", Inconsolata, "Calibri", Terminal, "Calibri", Courier;
        padding: 20px 15px;
        text-align: left;
      }
      header,
      section,
      aside,
      footer {
        margin: 1% 3px;
      }
      section {
        float: left;
        width: auto;
        height: auto;
      }
      aside {
        float: left;
        width: auto;
        height: auto;
      }
      footer {
        clear: both;
        margin-bottom: 0;
      }
      .radio1 {
        width: 40px;
        height: 40px;
      }

    </style>

<!-- ADD SOURCE FILES HERE! -->
<!-- Get version 1.5.0 of Fabric.js from CDN -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/fabric.js/1.5.0/fabric.min.js" ></script>
<script src="enrique.js"></script>
<script src="gabe.js"></script>
<script src="abeer.js"></script>
<script src="carlos.js"></script>


<body>
    <!-- canvas tag for Fabric.js to draw into -->
    <!-- set this to some appropriate size for your development work -->
    <!-- but keep the same aspect ratio -->
    <!-- we will use width="2714" height="2200" for presentations and evaluation -->
	<!-- <canvas id="c" width="494" height="400" style="border:2px solid black;" ></canvas> -->

  <video id="video1" style="display: none">
  <source src="tutorial.mp4">
  </video>

    <canvas id="c" width="2714" height="2200" style="border:2px solid black;" ></canvas>
    <section>
    <h1>Inside Events</h1>
    <code>
      <section>
      <code>
      <form> Users:<br>
        <div id = "UsersFromInside">
          <label for="NoSignalInside"><input type="radio" class="radio1" name="UsersIn" onchange="NoSignalFromInside()" value="NoSignal" checked> No One<br></label>
          <label for="UnknownPersonInside"><input type="radio" class="radio1" name="UsersIn" onchange="NewUserFromInside()" value="NewUser"> Unknown Person<br></label>
          <label for="MultiUserInside"><input type="radio" class="radio1" name="UsersIn" onchange="MultiUsersFromInside()" value="MultiUser"> Multiple People<br></label>
        </div>

      </form>
      </code>
      </section>

      <section>
      <code>
      <form > Heights:<br>
        <div id="Heights">
          <label for="Tall"><input type="radio" class="radio1" name="Heights" id='Tall' onchange="AdjustHeight(this.value)" value="Tall"> Tall<br></label>
          <label for="Medium"><input type="radio" class="radio1" name="Heights" id='Medium' onchange="AdjustHeight(this.value)" value="Medium" checked> Medium<br></label>
          <label for="Short"><input type="radio" class="radio1" name="Heights" id='Short' onchange="AdjustHeight(this.value)" value="Short"> Short<br></label>
        </div>
      </form>
      </code>
      </section>

    </code>
    </section>


    <section>
    <h1>Outside Events</h1>
    <code>


      <section>
      <code>
      <form name="UsersOutside"> Users:<br>
        <div id="UsersFromOutside">
          <label for="NoSignal"><input type="radio" class="radio1" name="UsersOut" onchange="NoOneOutside()" value="NoSignal" checked> No One<br></label>
          <label for="Unknown Person"><input type="radio" class="radio1" name="UsersOut" onchange="UnKnownPersonFromOutside()" value="NewUser"> Unknown Person<br></label>
          <label for="Multiple People"><input type="radio" class="radio1" name="UsersOut" onchange="MultiUsersOutside()" value="NewUser"> Multiple People<br></label>
        </div>
      </form></code>
      </section>


      <section>
      <code>
      <form name="Verification"> Form One:<br>
        <div id="Verification1">
          <label for="None"><input type="radio" class="radio1" name="verifyfirst" onchange="VerifyFirst(this.value)" id="noneA" value="None" disabled> None<br></label>
          <label for="Phone/KeyFOB"><input type="radio" class="radio1"  name="verifyfirst" onchange="VerifyFirst(this.value)" id="pkfobA" value="Phone/KeyFob" disabled> Phone/KeyFOB<br></label>
          <label for="FacialRecognition"><input type="radio" class="radio1"  name="verifyfirst" onchange="VerifyFirst(this.value)" id="faceA" value="FacialRecognition" disabled> Facial Recognition<br></label>
          <label for="FingerPrints"><input type="radio" class="radio1"  name="verifyfirst" onchange="VerifyFirst(this.value)" id="fingerA" value="FingerPrint" disabled> Finger Print<br></label>
          <label for="NumberPad"><input type="radio" class="radio1"  name="verifyfirst" onchange="VerifyFirst(this.value)" id="numberA" value="NumberPad" disabled> Number Pad<br></label>
        </div>
      </form>
      </code>
      </section>

      <section>
      <code>
      <form name="Verification"> Form Two:<br>
        <div id="Verification2">
          <label for="None"><input type="radio" class="radio1"  name="verifysecond" onchange="VerifySecond(this.value)" id="noneB" value="None" disabled> None<br></label>
          <label for="Phone/KeyFOB"><input type="radio" class="radio1" name="verifysecond"  onchange="VerifySecond(this.value)" id="pkfobB" value="Phone/KeyFob" disabled> Phone/KeyFOB<br></label>
          <label for="FacialRecognition"><input type="radio" class="radio1" name="verifysecond"  onchange="VerifySecond(this.value)" id="faceB" value="FacialRecognition" disabled> Facial Recognition<br></label>
          <label for="FingerPrints"><input type="radio" class="radio1" name="verifysecond" onchange="VerifySecond(this.value)" id="fingerB" value="FingerPrint" disabled> Finger Print<br></label>
          <label for="NumberPad"><input type="radio" class="radio1" name="verifysecond"  onchange="VerifySecond(this.value)" id="numberB" value="NumberPad" disabled> Number Pad<br></label>
        </div>
      </form>
      </code>
      </section>

      <section>
      <code>
      <form name="Verification"> Verification:<br>
        <div id="Verification2">
          <label for="Success"><input type="radio" class="radio1"  name="verify" onchange="Verify(this.value)" id="success" value="success" disabled > Success<br></label>
          <label for="Failure"><input type="radio" class="radio1" name="verify"  onchange="Verify(this.value)" id="failure" value="fail" disabled> Fail<br></label>
        </div>
      </form>
      </code>
      </section>

    </code>
    </section>
</body>

<script>





// the aspect ratios given here are not quite tall enough for a 36" x 80" door
// we are assuming bottom 15 inches of the door are not part of the display.
// that part contains lots of necessary electronics so the bottom of the door
// sits off the bottom of our display wall. You are implementing the interface
// for the top 65" of the display / door

//(function() {

// within the code below I assume I am drawing into a 1220x990 box
// then I can scale the group to whatever size the final canvas is
var localHeight = 990;
var localWidth = 1220;

//var checkedRB = $('input[type="radio"][name="layout"]:checked');

var canvas = this.__canvas = new fabric.Canvas('c');

// set background to blue to make it easier to see it
canvas.backgroundColor = "#DDDDDD";  // light grey

//****************************** System Settings Parameters *********************************

// syslang is an index into an array that represents a word in a language.
// ENGLISH = 0, SPANISH = 1, etc
var syslang = ENGLISH; // set to english by default
var System_language = SYSTEM_LANGUAGE[syslang];

// width for both doors
var doorwidth = 555;
// value for left side of rect object representing door, relative to the canvas
var inside_left = 22;
var outside_left = 642;

var In_theme = 'default';
var In_ornament = 'default';
var Out_theme = 'default';
var Out_ornament = 'default';

var Date_format = DATE_MONTHDDYYYY;
var Time_format = TIME_12HOUR;
var TemperatureUnits = F;

var HomeIsActive = false;
var SettingsIsActive = false;
var LanguageSettingIsActive = false;
var UserFingerIsRecognizable = false;
var Height = 0;
var ImgHeight = Height*2.22222222;
var RestartIsActive = false;
var AvatarIsActive = false;

var ArrayOfObjects = [];
var OriginalObjCoordinate = [];
var counter = 0;
HeightsRadioButtons_DISABLE();
var UsersNames = [];
var DoorbellAudio = 'ding';

//*******************************************************************************************

//************************************ Users Profiles ***************************************

var User0 = new User('Gabe', 'Mendoza', ENGLISH, 1234);
var User1 = new User('Enrique', 'Vaca', SPANISH, 1235);
var User2 = new User('Abeer','A.', ENGLISH, 1236);
var User3 = new User('Carlos', 'Beltran', SPANISH, 1237);



//*******************************************************************************************


// need 36 wide instead of 40 as now
//*************************** Inside & Outside door initialization **************************

var insideDoor = new fabric.Rect({
  left: inside_left,
  top: 0,
  fill: 'grey',
  stroke: 'black',
  width: doorwidth,
  height: localHeight,
  angle: 0
});

// the doors will not be selectable or movable
insideDoor.hasControls = insideDoor.hasBorders = insideDoor.selectable = false;
insideDoor.lockMovementX = insideDoor.lockMovementY = true;
// Default door pattern
fabric.util.loadImage('images/Doorpattern.gif', function (img) {
  insideDoor.setPatternFill({
    source: img,
    repeat: 'repeat'
  });
  canvas.renderAll();
});

var outsideDoor = new fabric.Rect({
  left: outside_left,
  top: 0,
  fill: 'grey',
  stroke: 'black',
  width: doorwidth,
  height: localHeight,
  angle: 0
});

outsideDoor.hasControls = outsideDoor.hasBorders = outsideDoor.selectable = false;
outsideDoor.lockMovementX = outsideDoor.lockMovementY = true;
// Default door pattern
fabric.util.loadImage('images/DoorpatternOut.gif', function (img) {
  outsideDoor.setPatternFill({
    source: img,
    repeat: 'repeat'
  });
  canvas.renderAll();
});
//*******************************************************************************************


//******************************* Adding Date/Time and weather ******************************

var Datetext = new fabric.Text('', {
  left: 102,
  top: 112,
  fontFamily: 'Calibri',
  fontSize: 20
});
Datetext.setColor('black');
Datetext.selectable = false;

var date_rect = new fabric.Rect({
  left: 85,
  top: 110,
  fill: 'lightgrey',
  stroke: 'darkgrey',
  width: 150,
  height: 25,
  angle: 0
});
date_rect.selectable = false;

var Timetext = new fabric.Text('', {
  left: 100,
  top: 76,
  fontFamily: 'Calibri',
  fontSize: 30
});

Timetext.setColor('black');
Timetext.selectable = false;

ShowDateTime();

var icon_weather;
fabric.Image.fromURL('images/weather.gif', function(oImg) {
  oImg.set({left: 800, top: 95, id: this.id});
  oImg.selectable = false;
  oImg.id = 'weather';
  icon_weather = oImg;
  canvas.add(icon_weather);
});

var Weathertext = new fabric.Text('49 F', {
  left: 475,
  top: 80,
  fontFamily: 'Calibri',
  fontSize: 30
});
Weathertext.setColor('black');
Weathertext.selectable = false;

var Weathertext = FabricText('49',475,80,30);

//*******************************************************************************************



//****************** Adding In/out Door knobs ******************************************
var doorknob_inside_locked;
  fabric.Image.fromURL('images/lockknob.png', function(oImg) {
  oImg.set({left: 1120, top: 1030, id: this.id});
  oImg.id = 'LockKnobIn';
  oImg.hasControls = oImg.hasBorders = false;
  oImg.visible = true;
  oImg.lockMovementY = oImg.lockMovementX = true;
  doorknob_inside_locked = oImg;
  canvas.add(doorknob_inside_locked);
//    console.log(doorknob_inside_locked);
});

var doorknob_inside_unlocked;
fabric.Image.fromURL('images/unlockknob2.png', function(oImg) {
  oImg.set({left: 1110, top: 1020, id: this.id});
  oImg.id = 'UnlockKnobIn';
  oImg.hasControls = oImg.hasBorders = false;
  oImg.visible = false;
  oImg.lockMovementY = oImg.lockMovementX = true;
  doorknob_inside_unlocked = oImg;
  canvas.add(doorknob_inside_unlocked);
});

var deadbolt_locked;
fabric.Image.fromURL('images/lockdeadbolt.png', function(oImg) {
  oImg.set({left: 1100, top: 680, id: this.id});
  oImg.id = 'LockDeadbolt';
  oImg.hasControls = oImg.hasBorders = false;
  oImg.lockMovementY = oImg.lockMovementX = true;
  deadbolt_locked = oImg;
  canvas.add(deadbolt_locked);
});

var deadbolt_unlocked;
fabric.Image.fromURL('images/unlockdeadbolt.png', function(oImg) {
  oImg.set({left: 1100, top: 680, id: this.id});
  oImg.id = 'UnlockDeadbolt';
  oImg.hasControls = oImg.hasBorders = false;
  oImg.visible = false;
  oImg.lockMovementY = oImg.lockMovementX = true;
  deadbolt_unlocked = oImg;
  canvas.add(deadbolt_unlocked);
});

var doorknob_outside_blank;
fabric.Image.fromURL('images/knob.png', function(oImg) {
  oImg.set({left: 1480, top: 1030, id: this.id});
  oImg.id = 'knob';
  oImg.hasControls = oImg.hasBorders = false;
  oImg.lockMovementY = oImg.lockMovementX = true;
  doorknob_outside_blank = oImg;
  canvas.add(doorknob_outside_blank);
});

var doorknob_outside_locked;
fabric.Image.fromURL('images/lockknob.png', function(oImg) {
  oImg.set({left: 1480, top: 1030, id: this.id});
  oImg.id = 'LockKnobOut';
  oImg.hasControls = oImg.hasBorders = false;
  oImg.visible = false;
  oImg.lockMovementY = oImg.lockMovementX = true;
  doorknob_outside_locked = oImg;
  canvas.add(doorknob_outside_locked);
});

var doorknob_outside_unlocked;
fabric.Image.fromURL('images/unlockknob2.png', function(oImg) {
  oImg.set({left: 1470, top: 1020, id: this.id});
  oImg.id = 'UnlockKnobOut';
  oImg.hasControls = oImg.hasBorders = false;
  oImg.visible = false;
  oImg.lockMovementY = oImg.lockMovementX = true;
  doorknob_outside_unlocked = oImg;
  canvas.add(doorknob_outside_unlocked);
});

var Deadbolttext = new fabric.Text(DEADBOLT[syslang], {
  left: 500,
  top: 293,
  fontFamily: 'Calibri',
  fontSize: 15
});
Deadbolttext.setColor('black');
Deadbolttext.selectable = false;
//********************************************************************************************



//*********************** Components called by functions *************************************
//To Do/Calender
var calendar_user1;
var calendar_user = new fabric.Image.fromURL('images/usercalender.gif', function(oImg) {
  oImg.set({left: 220, top: 750 + ImgHeight, id: this.id});
  oImg.visible = false;
  oImg.hasControls = oImg.hasBorders = false;
  oImg.lockMovementY = oImg.lockMovementX = true;
  oImg.id = 'user1calender';
  calendar_user1 = oImg
  ArrayOfObjects.push(calendar_user1);
  canvas.add(calendar_user1);
  User1.addObject(calendar_user1);
});


var calendar_user2;
fabric.Image.fromURL('images/usercalender.gif', function(oImg) {
  oImg.set({left: 220, top: 750 + ImgHeight, id: this.id});
  oImg.visible = false;
  oImg.hasControls = oImg.hasBorders = false;
  oImg.lockMovementY = oImg.lockMovementX = true;
  oImg.id = 'user2calender';
  calendar_user2 = oImg;
  ArrayOfObjects.push(calendar_user2);
  canvas.add(calendar_user2);
  User2.addObject(calendar_user2);
});

var todo_list_user1;
fabric.Image.fromURL('images/user1todo.gif', function(oImg) {
  oImg.set({left: 630, top: 750 + ImgHeight, id: this.id});
  oImg.visible = false;
  oImg.hasControls = oImg.hasBorders = false;
  oImg.lockMovementY = oImg.lockMovementX = true;
  oImg.id = 'user1todo';
  todo_list_user1 = oImg;
  ArrayOfObjects.push(todo_list_user1);
  canvas.add(todo_list_user1);
  User1.addObject(todo_list_user1);
});

var todo_list_user2;
fabric.Image.fromURL('images/user1todo.gif', function(oImg) {
  oImg.set({left: 630, top: 750 + ImgHeight, id: this.id});
  oImg.visible = false;
  oImg.hasControls = oImg.hasBorders = false;
  oImg.lockMovementY = oImg.lockMovementX = true;
  oImg.id = 'user2todo';
  todo_list_user2 = oImg;
  ArrayOfObjects.push(todo_list_user2);
  canvas.add(todo_list_user2);
  User2.addObject(todo_list_user2);
});


var list_of_users;
fabric.Image.fromURL('images/UsersList.gif', function(oImg) {
  oImg.set({left: 400, top: 730 + ImgHeight, id: this.id});
  oImg.visible = false;
  oImg.hasControls = oImg.hasBorders = false;
  oImg.lockMovementY = oImg.lockMovementX = true;
  oImg.id = 'userslist';
  list_of_users = oImg;
  ArrayOfObjects.push(list_of_users);
  canvas.add(list_of_users);
});

var name_user1;
fabric.Image.fromURL('images/user1name.gif', function(oImg) {
  oImg.set({left: 350, top: 830 + ImgHeight, id: this.id});
  oImg.visible = false;
  oImg.hasControls = oImg.hasBorders = false;
  oImg.lockMovementY = oImg.lockMovementX = true;
  oImg.id = 'user1name';
  name_user1 = oImg;
  ArrayOfObjects.push(name_user1);
  canvas.add(name_user1);
});

var name_user2;
fabric.Image.fromURL('images/user2name.gif', function(oImg) {
  oImg.set({left: 350, top: 911 + ImgHeight, id: this.id});
  oImg.visible = false;
  oImg.hasControls = oImg.hasBorders = false;
  oImg.lockMovementY = oImg.lockMovementX = true;
  oImg.id = 'user2name';
  name_user2 = oImg;
  ArrayOfObjects.push(name_user2);
  canvas.add(name_user2);
});


//******************************* Home Button ****************************************
var home_topheight = 555;

var icon_home;
fabric.Image.fromURL('images/home.gif', function(oImg) {
  oImg.set({left: 549, top: 555, id: this.id});
  oImg.id = 'home';
  oImg.hasControls = oImg.hasBorders = false;
  oImg.lockMovementY = oImg.lockMovementX = true;
  oImg.visible = false;
  icon_home = oImg;
  ArrayOfObjects.push(icon_home);
  canvas.add(icon_home);
});

var Line = new fabric.Line([100, 310, 460, 310], {
  lfill: 'black',
  stroke: 'black',
  strokeWidth: 0.5,
  visible: false
});
Line.selectable = false;
ArrayOfObjects.push(Line);
//********************************************************************************************



//********************************************************************************************
// Main panel components
var PanelRect = new fabric.Rect({
  left: 72,
  top: 310,
  fill: 'lightgrey',
  //stroke: 'darkgrey',
  width: 410,
  height: 200,
  angle: 0
});
PanelRect.visible = false;
PanelRect.hasControls = PanelRect.hasBorders = PanelRect.selectable = false;
PanelRect.lockMovementX = PanelRect.lockMovementY = true;

fabric.util.loadImage('images/background.jpg', function (img) {
  PanelRect.setPatternFill({
    source: img,
    repeat: 'repeat'
  });
});
ArrayOfObjects.push(PanelRect);
//********************************************************************************************



//********************************************************************************************
// FIRST COLUMN OF ITEMS
// MESSAGES
var icon_messages;
fabric.Image.fromURL('images/messages.gif', function(oImg) {
  oImg.set({left: 189, top: 730, id: this.id});
  oImg.visible = false;
  oImg.hasControls = oImg.hasBorders = false;
  oImg.lockMovementY = oImg.lockMovementX = true;
  oImg.id = 'messages';
  icon_messages = oImg;
  ArrayOfObjects.push(icon_messages);
  canvas.add(icon_messages);
});

var Messagestext = new fabric.Text(MESSAGES[syslang], {
  left: 85,
  top: 385,
  fontFamily: 'Times',
  fontSize: 15
});
Messagestext.setColor('black');
Messagestext.selectable = false;
Messagestext.visible = false;
ArrayOfObjects.push(Messagestext);

var MessagesDroplist = new fabric.Text('  Type of Message       ', {
  backgroundColor: 'lightgrey',
  borderColor: 'black',
  fontFamily: 'Times',
  fontSize: 23,
  padding: 5,
  left: 175,
  top: 310 ,
  width: 150,
  height: 50
});
MessagesDroplist.selectable = true;
MessagesDroplist.visible = false;
MessagesDroplist.hasBorders = true;
MessagesDroplist.hasControls =  false;
MessagesDroplist.lockMovementX = MessagesDroplist.lockMovementY = true;
ArrayOfObjects.push(MessagesDroplist);

var PublicText = new fabric.Text('  Public                        ', {
  backgroundColor: 'white',
  fontFamily: 'Times',
  fontSize: 23,
  padding: 5,
  left: 175,
  top: 345 ,
  width: 150,
  height: 50
});
PublicText.selectable = true;
PublicText.visible = false;
PublicText.hasBorders = false;
PublicText.hasControls =  false;
PublicText.lockMovementX = PublicText.lockMovementY = true;
ArrayOfObjects.push(PublicText);

var PrivateText = new fabric.Text('  Private                       ', {
  backgroundColor: 'white',
  fontFamily: 'Times',
  fontSize: 23,
  padding: 5,
  left: 175,
  top: 375 ,
  width: 150,
  height: 50
});
PrivateText.selectable = true;
PrivateText.visible = false;
PrivateText.hasBorders = false;
PrivateText.hasControls =  false;
PrivateText.lockMovementX = PrivateText.lockMovementY = true;
ArrayOfObjects.push(PrivateText);

function ShowMessageSettings()
{
  MessagesDroplist.visible = true;

  PublicText.visible = true;
  PrivateText.visible = true;

  PublicText.backgroundColor = 'white';
  PrivateText.backgroundColor = 'white';
  HomeSelected();
}

function CloseMessageSettings()
{
  MessagesDroplist.visible = false;
  PublicText.visible = false;
  PrivateText.visible = false;

}

PublicText.on('mousedown', function ()
{
  CloseMessageSettings();
  MessageBoxSelected();
});

function ShowUsers(){
  mBackButton.addToBackStack(showSettings,HideUserData);
  UsersNames = [];
  UserSettingList.visible = true;
  //UserSettingMsg.visible = false;
  //loop to get names and add them to canvas
  for (i = 0; i < RegisteredUsers.length; i++){
    var topv = 730 + (70*(i+1)/(i+1)) * (i+1);
    var UserName = new fabric.Text('', {
      fontFamily: 'Times',
      fontSize: 60,
      left: 400,
      top: topv,
    });

    UserName.setText(RegisteredUsers.at(i).firstname);

    UserName.on('mousedown', function ()
    {
      CloseMessageSettings();
      MessageBoxSelected();
    });
    canvas.add(UserName);
    UserName.bringForward();
    UsersNames.push(UserName);
    ArrayOfObjects.push(UsersNames[i]);
  }

  console.log("We are : "+ UsersNames.length);
  console.log("here : "+ UsersNames[1].top);
  console.log( "My array length a: " + ArrayOfObjects.length);


  for (i = 0; i < UsersNames.length; i++) {
    UsersNames[i].id = i;
  }
}


PrivateText.on('mousedown', function ()
{
  CloseMessageSettings();
  ShowUsers();
  //MessageBoxSelected();
});

var MessageBox = new fabric.Rect({
  left: 175,
  top: 400,
  //id: this.id,
  fill: 'grey',
  stroke: 'black',
  width: 210,
  height: 200,
  angle: 0
});
MessageBox.visible = false;
MessageBox.hasControls = MessageBox.hasBorders = MessageBox.selectable = false;
MessageBox.lockMovementX = MessageBox.lockMovementY = true;
MessageBox.id = 'messageBox';
fabric.util.loadImage('images/chalkboard.jpeg', function (img) {
  MessageBox.setPatternFill({
      source: img,
      repeat: 'no-repeat'
  });
});
ArrayOfObjects.push(MessageBox);

var accept_button;
fabric.Image.fromURL('images/accept.png', function(oImg) {
  oImg.set({left: 505, top: 1350, width: 210, height: 120,id: this.id});
  oImg.visible = false;
  oImg.hasControls = oImg.hasBorders = false;
  oImg.lockMovementY = oImg.lockMovementX = true;
  oImg.id = 'accept';
  accept_button = oImg;
  ArrayOfObjects.push(accept_button);
  canvas.add(accept_button);
});

var MessageHelloOutside = new fabric.Rect({
  left: 810,
  top: 310,
  //id: this.id,
  fill: 'grey',
  stroke: 'black',
  width: 210,
  height: 200,
  angle: 0
});

MessageHelloOutside.visible = false;
MessageHelloOutside.hasControls = MessageHelloOutside.hasBorders = MessageHelloOutside.selectable = false;
MessageHelloOutside.lockMovementX = MessageHelloOutside.lockMovementY = true;
fabric.util.loadImage('images/chalkboard_hello.jpeg', function (img) {
  MessageHelloOutside.setPatternFill({
      source: img,
      repeat: 'repeat'
  });
});
ArrayOfObjects.push(MessageHelloOutside);

// MIRROR
var Mirror = new fabric.Rect({
  left: 22,
  top: 0,
  fill: 'grey',
  stroke: 'black',
  width: 555,
  height: localHeight,
  angle: 0
});
Mirror.visible = false;
Mirror.hasControls = Mirror.hasBorders = Mirror.selectable = false;
Mirror.lockMovementX = Mirror.lockMovementY = true;

fabric.util.loadImage('images/mirrorwomen.gif', function (img) {
  Mirror.setPatternFill({
    source: img,
    ßrepeat: 'repeat'
  });
});

var icon_mirror;
fabric.Image.fromURL('images/mirror.gif', function(oImg) {
  oImg.set({left: 189, top: 925, id: this.id});
  oImg.visible = false;
  oImg.hasControls = oImg.hasBorders = false;
  oImg.lockMovementY = oImg.lockMovementX = true;
  oImg.id = 'mirror';
  icon_mirror = oImg;
  ArrayOfObjects.push(icon_mirror);
  canvas.add(icon_mirror);
});

var Mirrortext = new fabric.Text(MIRROR[syslang], {
  left: 95,
  top: 475,
  fontFamily: 'Times',
  fontSize: 15
});
  Mirrortext.setColor('black');
  Mirrortext.selectable = false;
  Mirrortext.visible = false;
  ArrayOfObjects.push(Mirrortext);

//********************************************************************************************


//********************************************************************************************
// SECOND COLUMN OF ITEMS
// CAMERA
var icon_camera;
fabric.Image.fromURL('images/camera.gif', function(oImg) {
  oImg.set({left: 369, top: 735, id: this.id});
  oImg.visible = false;
  oImg.hasControls = oImg.hasBorders = false;
  oImg.lockMovementY = oImg.lockMovementX = true;
  oImg.id = 'camera';
  icon_camera  = oImg;
  ArrayOfObjects.push(icon_camera);
  canvas.add(icon_camera);
});

var Cameratext = new fabric.Text(CAMERA[syslang], {
  left: 165,
  top: 385,
  fontFamily: 'Times',
  fontSize: 15
});
Cameratext.setColor('black');
Cameratext.selectable = false;
Cameratext.visible = false;
ArrayOfObjects.push(Cameratext);

// LIGHTS
var icon_lights;
fabric.Image.fromURL('images/lights.gif', function(oImg) {
  oImg.set({left: 369, top: 920, id: this.id});
  oImg.visible = false;
  oImg.hasControls = oImg.hasBorders = false;
  oImg.lockMovementY = oImg.lockMovementX = true;
  oImg.id = 'lights';
  icon_lights = oImg;
  ArrayOfObjects.push(icon_lights);
  canvas.add(oImg);
});

var Lightstext = new fabric.Text(LIGHTS[syslang], {
  left: 175,
  top: 475,
  fontFamily: 'Times',
  fontSize: 15
});
Lightstext.setColor('black');
Lightstext.selectable = false;
Lightstext.visible = false;
ArrayOfObjects.push(Lightstext);

var Lights = new fabric.Rect({
  left: 22,
  top: 0,
  fill: 'grey',
  stroke: 'black',
  width: 555,
  height: localHeight,
  angle: 0
});
Lights.visible = false;
Lights.hasControls = Lights.hasBorders = Lights.selectable = false;
Lights.lockMovementX = Lights.lockMovementY = true;

fabric.util.loadImage('images/black.gif', function (img) {
  Lights.setPatternFill({
    source: img,
    repeat: 'repeat'
  });
});
//ArrayOfObjects.push(Lights);
//********************************************************************************************


//********************************************************************************************
// THIRD COLUMN OF ITEMS
// TRAFFIC
var icon_traffic;
fabric.Image.fromURL('images/traffic.gif', function(oImg) {
  oImg.set({left: 549, top: 720, id: this.id});
  oImg.visible = false;
  oImg.hasControls = oImg.hasBorders = false;
  oImg.lockMovementY = oImg.lockMovementX = true;
  oImg.id = 'traffic';
  icon_traffic = oImg;
  ArrayOfObjects.push(icon_traffic);
  canvas.add(icon_traffic);
});

var Traffictext = new fabric.Text(TRAFFIC[syslang], {
  left: 255,
  top: 385,
  fontFamily: 'Times',
  fontSize: 15
});
Traffictext.setColor('black');
Traffictext.selectable = false;
Traffictext.visible = false;
ArrayOfObjects.push(Traffictext);

var Traffic = new fabric.Rect({
  left: 175,
  top: 310,
  fill: 'grey',
  stroke: 'black',
  width: 210,
  height: 200,
  angle: 0
});
Traffic.visible = false;
Traffic.hasControls = Traffic.hasBorders = Traffic.selectable = false;
Traffic.lockMovementX = Traffic.lockMovementY = true;

fabric.util.loadImage('images/traffic.png', function (img) {
  Traffic.setPatternFill({
      source: img,
      repeat: 'repeat'
  });
});
ArrayOfObjects.push(Traffic);

// ALARM
var icon_alarm_off;
fabric.Image.fromURL('images/alarm.gif', function(oImg) {
  oImg.set({left: 549, top: 920, id: this.id});
  oImg.visible = false;
  oImg.hasControls = oImg.hasBorders = false;
  oImg.lockMovementY = oImg.lockMovementX = true;
  oImg.id = 'alarm';
  icon_alarm_off = oImg;
  ArrayOfObjects.push(icon_alarm_off);
  canvas.add(icon_alarm_off);
});

//var icon_alarm_on;
//fabric.Image.fromURL('images/alarmOn.gif', function(oImg) {
//  oImg.set({left: 549, top: 920, id: this.id});
//  oImg.visible = false;
//  oImg.hasControls = oImg.hasBorders = false;
//  oImg.lockMovementY = oImg.lockMovementX = true;
//  oImg.id = 'alarmOn';
//  icon_alarm_on = oImg;
//  canvas.add(icon_alarm_on);
//});

var icon_alarm_on;
fabric.Image.fromURL('images/alarmOn.gif', function(oImg) {
  oImg.set({left: 549, top: 920, id: this.id});
  oImg.visible = false;
  oImg.hasControls = oImg.hasBorders = false;
  oImg.lockMovementY = oImg.lockMovementX = true;
  oImg.id = 'alarmOn';
  icon_alarm_on = oImg;
  ArrayOfObjects.push(icon_alarm_on);
  canvas.add(icon_alarm_on);
});

var Alarmtext = new fabric.Text(ALARM[syslang], {
  left: 255,
  top: 475,
  fontFamily: 'Times',
  fontSize: 15
});
Alarmtext.setColor('black');
Alarmtext.selectable = false;
Alarmtext.visible = false;
ArrayOfObjects.push(Alarmtext);
//********************************************************************************************



//********************************************************************************************
// FOURTH COLUMN OF ITEMS
// TRANSPORT - CTA
var icon_trasportation;
fabric.Image.fromURL('images/cta.gif', function(oImg) {
  oImg.set({left: 729, top: 720, id: this.id});
  oImg.visible = false;
  oImg.hasControls = oImg.hasBorders = false;
  oImg.lockMovementY = oImg.lockMovementX = true;
  oImg.id = 'cta';
  icon_trasportation = oImg;
  ArrayOfObjects.push(icon_trasportation);
  canvas.add(icon_trasportation);
});

var Transporttext = new fabric.Text(TRANSPORT[syslang], {
  left: 330,
  top: 385,
  fontFamily: 'Times',
  fontSize: 15
});
Transporttext.setColor('black');
Transporttext.selectable = false;
Transporttext.visible = false;
ArrayOfObjects.push(Transporttext);

var Transport = new fabric.Rect({
  left: 185,
  top: 310,
  width: 187,
  height: 195,
  angle: 0
});
Transport.visible = false;
Transport.hasControls = Transport.hasBorders = Transport.selectable = false;
Transport.lockMovementX = Transport.lockMovementY = true;

fabric.util.loadImage('images/transport.jpeg', function (img) {
  Transport.setPatternFill({
    source: img,
    repeat: 'repeat'
  });
});
ArrayOfObjects.push(Transport);

// EMERGENCY
var icon_911;
fabric.Image.fromURL('images/911.gif', function(oImg) {
  oImg.set({left: 729, top: 935, id: this.id});
  oImg.visible = false;
  oImg.hasControls = oImg.hasBorders = false;
  oImg.lockMovementY = oImg.lockMovementX = true;
  oImg.id = '911';
  icon_911 = oImg;
  ArrayOfObjects.push(icon_911);
  canvas.add(icon_911);
});

var Emergtext = new fabric.Text(EMERGENCY[syslang], {
  left: 325,
  top: 475,
  fontFamily: 'Times',
  fontSize: 15
});
Emergtext.setColor('black');
Emergtext.selectable = false;
Emergtext.visible = false;
ArrayOfObjects.push(Emergtext);
//********************************************************************************************


//********************************************************************************************
// FIFTH COLUMN OF ITEMS
// NEWS
var icon_news;
fabric.Image.fromURL('images/news.gif', function(oImg) {
  oImg.set({left: 909, top: 730, id: this.id});
  oImg.visible = false;
  oImg.hasControls = oImg.hasBorders = false;
  oImg.lockMovementY = oImg.lockMovementX = true;
  oImg.id = 'news';
  icon_news = oImg;
  ArrayOfObjects.push(icon_news);
  canvas.add(icon_news);
});

var Newstext = new fabric.Text(NEWS[syslang], {
  left: 420,
  top: 385,
  fontFamily: 'Times',
  fontSize: 15
});
Newstext.setColor('black');
Newstext.selectable = false;
Newstext.visible = false;
ArrayOfObjects.push(Newstext);

var News = new fabric.Rect({
  left: 135,
  top: 310,
  //fill: 'grey',
  //stroke: 'black',
  width: 300,
  height: 202,
  angle: 0
});
News.visible = false;
News.hasControls = News.hasBorders = News.selectable = false;
News.lockMovementX = News.lockMovementY = true;

fabric.util.loadImage('images/news.jpg', function (img) {
  News.setPatternFill({
    source: img,
    repeat: 'repeat'
  });
});
ArrayOfObjects.push(News);

// SETTINGS
var icon_settings;
fabric.Image.fromURL('images/settings.gif', function(oImg) {
  oImg.set({left: 909, top: 930, id: this.id});
  oImg.visible = false;
  oImg.hasControls = oImg.hasBorders = false;
  oImg.lockMovementY = oImg.lockMovementX = true;
  oImg.id = 'settings';
  icon_settings = oImg;
  icon_settings.selectable = false;
  ArrayOfObjects.push(icon_settings);
  canvas.add(icon_settings);
});

var Settingstext = new fabric.Text(SETTINGS[syslang], {
  left: 415,
  top: 475,
  fontFamily: 'Times',
  fontSize: 15
});
Settingstext.setColor('black');
Settingstext.selectable = false;
Settingstext.visible = false;
ArrayOfObjects.push(Settingstext);


//********************************************************************************************
// SETTINGS PANEL
//********************************************************************************************
// FIRST COLUMN OF ITEMS
// User
var icon_users;
fabric.Image.fromURL('images/Settings/users.gif', function(oImg) {
  oImg.set({left: 189, top: 730, id: this.id});
  oImg.visible = false;
  oImg.hasControls = oImg.hasBorders = false;
  oImg.lockMovementY = oImg.lockMovementX = true;
  oImg.id = 'settings_users';
  icon_users = oImg;
  ArrayOfObjects.push(icon_users);
  canvas.add(icon_users);
});

var UsersText = new fabric.Text(USERS[syslang], {
  left: 94,
  top: 389,
  fontFamily: 'Times',
  fontSize: 15
});
UsersText.setColor('black');
UsersText.selectable = false;
UsersText.visible = false;
ArrayOfObjects.push(UsersText);

var UserPanel = new fabric.Rect({
  left: 155,
  top: 310,
  fill: 'grey',
  stroke: 'black',
  width: 274,
  height: 194,
  angle: 0
});
UserPanel.visible = false;
UserPanel.hasControls = UserPanel.hasBorders = false;
UserPanel.lockMovementX = UserPanel.lockMovementY = true;
UserPanel.id = 'user_panel';

fabric.util.loadImage('images/Settings/users_gabe_active.gif', function (img) {
  UserPanel.setPatternFill({
    source: img,
    repeat: 'repeat'
  });
});
ArrayOfObjects.push(UserPanel);

var sendKey = new fabric.Rect({
  left: 165,
  top: 315,
  fill: 'grey',
  stroke: 'black',
  width: 230,
  height: 175,
  angle: 0
});
sendKey.visible = false;
sendKey.hasControls = sendKey.hasBorders = false;
sendKey.lockMovementX = sendKey.lockMovementY = true;
sendKey.id = 'sendKey';

fabric.util.loadImage('images/Settings/init_send_key.gif', function (img) {
  sendKey.setPatternFill({
    source: img,
    repeat: 'no-repeat'
  });
});
ArrayOfObjects.push(sendKey);

var input_sendKey = new fabric.Rect({
  left: 165,
  top: 315,
  fill: 'grey',
  stroke: 'black',
  width: 230,
  height: 175,
  angle: 0
});
input_sendKey.visible = false;
input_sendKey.hasControls = input_sendKey.hasBorders = false;
input_sendKey.lockMovementX = input_sendKey.lockMovementY = true;
input_sendKey.id = 'input_send_key';

fabric.util.loadImage('images/Settings/input_send_key.gif', function (img) {
  input_sendKey.setPatternFill({
    source: img,
    repeat: 'no-repeat'
  });
});
ArrayOfObjects.push(input_sendKey);

var post_sendKey = new fabric.Rect({
  left: 160,
  top: 310,
  fill: 'grey',
  stroke: 'black',
  width: 255,
  height: 214,
  angle: 0
});
post_sendKey.visible = false;
post_sendKey.hasControls = post_sendKey.hasBorders = false;
post_sendKey.lockMovementX = post_sendKey.lockMovementY = true;
post_sendKey.id = 'post_sendKey';

fabric.util.loadImage('images/Settings/post_send_key.gif', function (img) {
  post_sendKey.setPatternFill({
    source: img,
    repeat: 'no-repeat'
  });
});
ArrayOfObjects.push(post_sendKey);


// language
var icon_language;
fabric.Image.fromURL('images/Settings/language.gif', function(oImg) {
  oImg.set({left: 189, top: 925, id: this.id});
  oImg.visible = false;
  oImg.hasControls = oImg.hasBorders = false;
  oImg.lockMovementY = oImg.lockMovementX = true;
  oImg.id = 'settings_language';
  icon_language = oImg;
  ArrayOfObjects.push(icon_language);
  canvas.add(icon_language);
});

var LanguageText = new fabric.Text(LANGUAGE[syslang], {
  left: 84,
  top: 475,
  fontFamily: 'Times',
  fontSize: 15
});
  LanguageText.setColor('black');
  LanguageText.selectable = false;
  LanguageText.visible = false;
  ArrayOfObjects.push(LanguageText);

//********************************************************************************************


//********************************************************************************************
// SECOND COLUMN OF ITEMS
// Traffic
var icon_traffic;
fabric.Image.fromURL('images/Settings/traffic.gif', function(oImg) {
  oImg.set({left: 369, top: 735, id: this.id});
  oImg.visible = false;
  oImg.hasControls = oImg.hasBorders = false;
  oImg.lockMovementY = oImg.lockMovementX = true;
  oImg.id = 'settings_traffic';
  icon_traffic  = oImg;
  ArrayOfObjects.push(icon_traffic);
  canvas.add(icon_traffic);
});

var TrafficText = new fabric.Text(TRAFFIC[syslang], {
  left: 173,
  top: 389,
  fontFamily: 'Times',
  fontSize: 15
});
TrafficText.setColor('black');
TrafficText.selectable = false;
TrafficText.visible = false;
ArrayOfObjects.push(TrafficText);

// options
var traffic_option_work = new fabric.Rect({
  left: 165,
  top: 335,
  fill: 'grey',
  stroke: 'black',
  width: 180,
  height: 50,
  angle: 0
});
traffic_option_work.visible = false;
traffic_option_work.hasControls = traffic_option_work.hasBorders =  traffic_option_work.selectable = false;
traffic_option_work.lockMovementX = traffic_option_work.lockMovementY = true;
traffic_option_work.id = 'traffic_option_work';

fabric.util.loadImage('images/Settings/traffic_option_work.gif', function (img) {
  traffic_option_work.setPatternFill({
    source: img,
    repeat: 'no-repeat'
  });
});
ArrayOfObjects.push(traffic_option_work);

var traffic_option_barber = new fabric.Rect({
  left: 165,
  top: 390,
  fill: 'grey',
  stroke: 'black',
  width: 180,
  height: 50,
  angle: 0
});
traffic_option_barber.visible = false;
traffic_option_barber.hasControls = traffic_option_barber.hasBorders =  traffic_option_barber.selectable = false;
traffic_option_barber.lockMovementX = traffic_option_barber.lockMovementY = true;
traffic_option_barber.id = 'traffic_option_work';

fabric.util.loadImage('images/Settings/traffic_option_barber.gif', function (img) {
  traffic_option_barber.setPatternFill({
    source: img,
    repeat: 'no-repeat'
  });
});
ArrayOfObjects.push(traffic_option_barber);

var traffic_option_moms = new fabric.Rect({
  left: 165,
  top: 335,
  fill: 'grey',
  stroke: 'black',
  width: 180,
  height: 50,
  angle: 0
});
traffic_option_moms.visible = false;
traffic_option_moms.hasControls = traffic_option_moms.hasBorders =  traffic_option_moms.selectable = false;
traffic_option_moms.lockMovementX = traffic_option_moms.lockMovementY = true;
traffic_option_moms.id = 'traffic_option_moms';

fabric.util.loadImage('images/Settings/traffic_option_moms.gif', function (img) {
  traffic_option_moms.setPatternFill({
    source: img,
    repeat: 'no-repeat'
  });
});
ArrayOfObjects.push(traffic_option_moms);

user_traffic_options.push(traffic_option_moms);
user_traffic_options.push(traffic_option_work);
user_traffic_options.push(traffic_option_barber);

// Stars
var traffic_star1 = new fabric.Rect({
  left: 165,
  top: 335,
  fill: 'grey',
  stroke: 'black',
  width: 50,
  height: 45,
  angle: 0
});
traffic_star1.visible = false;
traffic_star1.hasControls = traffic_star1.hasBorders = false;
traffic_star1.lockMovementX = traffic_star1.lockMovementY = true;
traffic_star1.id = 'traffic_star1';

fabric.util.loadImage('images/Settings/traffic_star.gif', function (img) {
  traffic_star1.setPatternFill({
    source: img,
    repeat: 'no-repeat'
  });
});
ArrayOfObjects.push(traffic_star1);

var traffic_star2 = new fabric.Rect({
  left: 165,
  top: 430,
  fill: 'grey',
  stroke: 'black',
  width: 50,
  height: 45,
  angle: 0
});
traffic_star2.visible = false;
traffic_star2.hasControls = traffic_star2.hasBorders = false;
traffic_star2.lockMovementX = traffic_star2.lockMovementY = true;
traffic_star2.id = 'traffic_star2';

fabric.util.loadImage('images/Settings/traffic_star.gif', function (img) {
  traffic_star2.setPatternFill({
    source: img,
    repeat: 'no-repeat'
  });
});
ArrayOfObjects.push(traffic_star2);

stars.push(traffic_star1);
stars.push(traffic_star2);

var traffic_add_btn = new fabric.Rect({
  left: 165,
  top: 500,
  fill: 'white',
  stroke: 'black',
  strokeWidth: 4,
  width: 74,
  height: 51,
  angle: 0
});
traffic_add_btn.visible = false;
traffic_add_btn.hasControls = traffic_add_btn.hasBorders = false;
traffic_add_btn.lockMovementX = traffic_add_btn.lockMovementY = true;
traffic_add_btn.id = 'traffic_add_btn';

var traffic_add_btn_text = new fabric.IText('Add', {
  fontFamily: 'arial black',
  fontSize: 20,
  left: 170,
  top: 515,
  width: 100,
  height: 50
});
traffic_add_btn_text.visible = false;
traffic_add_btn_text.hasControls = traffic_add_btn_text.hasBorders = false;
traffic_add_btn_text.lockMovementX = traffic_add_btn_text.lockMovementY = true;
traffic_add_btn_text.id = 'traffic_add_btn_text';

ArrayOfObjects.push(traffic_add_btn);
ArrayOfObjects.push(traffic_add_btn_text);

var traffic_save_btn = new fabric.Rect({
  left: 165,
  top: 500,
  fill: 'white',
  stroke: 'black',
  strokeWidth: 4,
  width: 65,
  height: 46,
  angle: 0
});
traffic_save_btn.visible = false;
traffic_save_btn.hasControls = traffic_save_btn.hasBorders = false;
traffic_save_btn.lockMovementX = traffic_save_btn.lockMovementY = true;
traffic_save_btn.id = 'traffic_save_btn';

var traffic_save_btn_text = new fabric.IText('Save', {
  fontFamily: 'arial black',
  fontSize: 20,
  left: 165,
  top: 510 ,
  width: 100,
  height: 50
});
traffic_save_btn_text.visible = false;
traffic_save_btn_text.hasControls = traffic_save_btn_text.hasBorders = false;
traffic_save_btn_text.lockMovementX = traffic_save_btn_text.lockMovementY = true;
traffic_save_btn_text.id = 'traffic_save_btn_text';

ArrayOfObjects.push(traffic_save_btn);
ArrayOfObjects.push(traffic_save_btn_text);

var traffic_input_name = new fabric.Rect({
  left: 165,
  top: 330,
  fill: 'white',
  stroke: 'black',
  strokeWidth: 4,
  width: 250,
  height: 50,
  angle: 0
});
traffic_input_name.visible = false;
traffic_input_name.hasControls = traffic_input_name.hasBorders = traffic_input_name.selectable = false;
traffic_input_name.lockMovementX = traffic_input_name.lockMovementY = true;
traffic_input_name.id = 'traffic_input_name';

var traffic_input_name_text = new fabric.IText('Type your name...', {
  fontFamily: 'arial black',
  fontSize: 20,
  left: 170,
  top: 340 ,
  width: 100,
  height: 50
});
traffic_input_name_text.visible = false;
traffic_input_name_text.hasControls = traffic_input_name_text.hasBorders = traffic_input_name_text.selectable = false;
traffic_input_name_text.lockMovementX = traffic_input_name_text.lockMovementY = true;
traffic_input_name_text.id = 'traffic_input_name_text';

ArrayOfObjects.push(traffic_input_name);
ArrayOfObjects.push(traffic_input_name_text);

var traffic_input_address = new fabric.Rect({
  left: 165,
  top: 400,
  fill: 'white',
  stroke: 'black',
  strokeWidth: 4,
  width: 275,
  height: 75,
  angle: 0
});
traffic_input_address.visible = false;
traffic_input_address.hasControls = traffic_input_address.hasBorders = traffic_input_address.selectable = false;
traffic_input_address.lockMovementX = traffic_input_address.lockMovementY = true;
traffic_input_address.id = 'traffic_input_address';

var traffic_input_address_text = new fabric.IText('The address...', {
  fontFamily: 'arial black',
  fontSize: 20,
  left: 170,
  top: 410 ,
  width: 100,
  height: 50
});
traffic_input_address_text.visible = false;
traffic_input_address_text.hasControls = traffic_input_address_text.hasBorders = traffic_input_address_text.selectable = false;
traffic_input_address_text.lockMovementX = traffic_input_address_text.lockMovementY = true;
traffic_input_address_text.id = 'traffic_input_address_text';

ArrayOfObjects.push(traffic_input_address);
ArrayOfObjects.push(traffic_input_address_text);

// DATE/TIME
var icon_datetime;
fabric.Image.fromURL('images/Settings/datetime.gif', function(oImg) {
  oImg.set({left: 369, top: 920, id: this.id});
  oImg.visible = false;
  oImg.hasControls = oImg.hasBorders = false;
  oImg.lockMovementY = oImg.lockMovementX = true;
  oImg.id = 'settings_datetime';
  icon_datetime = oImg;
  ArrayOfObjects.push(icon_datetime);
  canvas.add(oImg);
});

var DatetimeText = new fabric.Text(DATE_TIME[syslang], {
  left: 160,
  top: 475,
  fontFamily: 'Times',
  fontSize: 15
});
DatetimeText.setColor('black');
DatetimeText.selectable = false;
DatetimeText.visible = false;
ArrayOfObjects.push(DatetimeText);


//********************************************************************************************
// THIRD COLUMN OF ITEMS
// Doorbell
var icon_doorbell;
fabric.Image.fromURL('images/Settings/doorbell.gif', function(oImg) {
  oImg.set({left: 549, top: 720, id: this.id});
  oImg.visible = false;
  oImg.hasControls = oImg.hasBorders = false;
  oImg.lockMovementY = oImg.lockMovementX = true;
  oImg.id = 'settings_doorbell';
  icon_doorbell = oImg;
  ArrayOfObjects.push(icon_doorbell);
  canvas.add(icon_doorbell);
});

var DoorbellText = new fabric.Text(DOORBELL[syslang], {
  left: 255,
  top: 385,
  fontFamily: 'Times',
  fontSize: 15
});
DoorbellText.setColor('black');
DoorbellText.selectable = false;
DoorbellText.visible = false;
ArrayOfObjects.push(DoorbellText);

// Units
var icon_units;
fabric.Image.fromURL('images/Settings/metric.gif', function(oImg) {
  oImg.set({left: 549, top: 920, id: this.id});
  oImg.visible = false;
  oImg.hasControls = oImg.hasBorders = false;
  oImg.lockMovementY = oImg.lockMovementX = true;
  oImg.id = 'settings_units';
  icon_units = oImg;
  ArrayOfObjects.push(icon_units);
  canvas.add(icon_units);
});

var UnitsText = new fabric.Text(UNITS[syslang], {
  left: 255,
  top: 475,
  fontFamily: 'Times',
  fontSize: 15
});
UnitsText.setColor('black');
UnitsText.selectable = false;
UnitsText.visible = false;
ArrayOfObjects.push(UnitsText);
//********************************************************************************************

//********************************************************************************************
// FOURTH COLUMN OF ITEMS
// Brightness
var icon_brightness;
fabric.Image.fromURL('images/Settings/brightness.gif', function(oImg) {
  oImg.set({left: 729, top: 720, id: this.id});
  oImg.visible = false;
  oImg.hasControls = oImg.hasBorders = false;
  oImg.lockMovementY = oImg.lockMovementX = true;
  oImg.id = 'settings_brightness';
  icon_brightness = oImg;
  ArrayOfObjects.push(icon_brightness);
  canvas.add(icon_brightness);
});

var BrightnessText = new fabric.Text(BRIGHTNESS[syslang], {
  left: 330,
  top: 385,
  fontFamily: 'Times',
  fontSize: 15
});
BrightnessText.setColor('black');
BrightnessText.selectable = false;
BrightnessText.visible = false;
ArrayOfObjects.push(BrightnessText);

// Volume
var icon_volume;
fabric.Image.fromURL('images/Settings/volume.gif', function(oImg) {
  oImg.set({left: 729, top: 935, id: this.id});
  oImg.visible = false;
  oImg.hasControls = oImg.hasBorders = false;
  oImg.lockMovementY = oImg.lockMovementX = true;
  oImg.id = 'settings_volume';
  icon_volume = oImg;
  ArrayOfObjects.push(icon_volume);
  canvas.add(icon_volume);
});

var VolumeText = new fabric.Text(VOLUME[syslang], {
  left: 332,
  top: 477,
  fontFamily: 'Times',
  fontSize: 15
});
VolumeText.setColor('black');
VolumeText.selectable = false;
VolumeText.visible = false;
ArrayOfObjects.push(VolumeText);
//********************************************************************************************


//********************************************************************************************
// FIFTH COLUMN OF ITEMS
// Themes
var icon_themes;
fabric.Image.fromURL('images/Settings/themes.gif', function(oImg) {
  oImg.set({left: 909, top: 730, id: this.id});
  oImg.visible = false;
  oImg.hasControls = oImg.hasBorders = false;
  oImg.lockMovementY = oImg.lockMovementX = true;
  oImg.id = 'settings_themes';
  icon_themes = oImg;
  ArrayOfObjects.push(icon_themes);
  canvas.add(icon_themes);
});

var ThemesText = new fabric.Text(THEME[syslang], {
  left: 420,
  top: 388,
  fontFamily: 'Times',
  fontSize: 15
});
ThemesText.setColor('black');
ThemesText.selectable = false;
ThemesText.visible = false;
ArrayOfObjects.push(ThemesText);

// Intercom
var icon_intercom;
fabric.Image.fromURL('images/Settings/tutorial.gif', function(oImg) {
  oImg.set({left: 909, top: 930, id: this.id});
  oImg.visible = false;
  oImg.hasControls = oImg.hasBorders = false;
  oImg.lockMovementY = oImg.lockMovementX = true;
  oImg.id = 'settings_intercom';
  icon_intercom = oImg;
  ArrayOfObjects.push(icon_intercom);
  canvas.add(icon_intercom);
});

var IntercomText = new fabric.Text(INTERCOM[syslang], {
  left: 415,
  top: 475,
  fontFamily: 'Times',
  fontSize: 15
});
IntercomText.setColor('black');
IntercomText.selectable = false;
IntercomText.visible = false;
ArrayOfObjects.push(IntercomText);
//********************************************************************************************

// BRIGHTNESSSSS

var brightness_text = new fabric.IText('Brightness', {
  fontFamily: 'arial black',
  fontSize: 30,
  left: 185,
  top: 325,
  width: 100,
  height: 50
});
brightness_text.visible = false;
brightness_text.hasControls = brightness_text.hasBorders = brightness_text.selectable = false;
brightness_text.lockMovementX = brightness_text.lockMovementY = true;
brightness_text.id = 'brightness_text';

ArrayOfObjects.push(brightness_text);

var slider_back = new fabric.Rect({
  left: 110,
  top: 375,
  fill: 'grey',
  width: 328,
  height: 10,
  angle: 0
});
slider_back.visible = false;
slider_back.hasControls = slider_back.hasBorders = false;
slider_back.lockMovementX = slider_back.lockMovementY = true;
slider_back.id = 'slider_back';

fabric.util.loadImage('images/Settings/slider_back.gif', function (img) {
  slider_back.setPatternFill({
    source: img,
    repeat: 'no-repeat'
  });
});
ArrayOfObjects.push(slider_back);

var slider = new fabric.Rect({
  left: slider_back.left + slider_back.width,
  top: 355,
  fill: 'grey',
  width: 54,
  height: 55,
  angle: 0
});
slider.visible = false;
slider.hasControls = slider.hasBorders = false;
slider.lockMovementY = true;
slider.id = 'slider';

fabric.util.loadImage('images/Settings/slider.gif', function (img) {
  slider.setPatternFill({
    source: img,
    repeat: 'no-repeat'
  });
});
ArrayOfObjects.push(slider);

var display_text = new fabric.IText('Display Timer', {
  fontFamily: 'arial black',
  fontSize: 30,
  left: 165,
  top: 405,
  width: 100,
  height: 50
});
display_text.visible = false;
display_text.hasControls = display_text.hasBorders = display_text.selectable = false;
display_text.lockMovementX = display_text.lockMovementY = true;
display_text.id = 'brightness_text';

ArrayOfObjects.push(display_text);

var one_min_btn = new fabric.Rect({
  left: 110,
  top: 450,
  fill: 'light-gray',
  stroke: 'black',
  strokeWidth: 4,
  width: 95,
  height: 60,
  angle: 0
});
one_min_btn.visible = false;
one_min_btn.hasControls = one_min_btn.hasBorders = false;
one_min_btn.lockMovementX = one_min_btn.lockMovementY = true;
one_min_btn.id = 'one_min_btn';

var one_min_btn_text = new fabric.IText('1 min', {
  fontFamily: 'arial black',
  fontSize: 25,
  left: 117,
  top: 465,
  width: 60,
  height: 50
});
one_min_btn_text.visible = false;
one_min_btn_text.hasControls = one_min_btn_text.hasBorders = false;
one_min_btn_text.lockMovementX = one_min_btn_text.lockMovementY = true;
one_min_btn_text.id = 'one_min_btn_text';

ArrayOfObjects.push(one_min_btn_text);
ArrayOfObjects.push(one_min_btn);

var three_min_btn = new fabric.Rect({
  left: 230,
  top: 450,
  fill: 'light-gray',
  stroke: 'blue',
  strokeWidth: 4,
  width: 95,
  height: 60,
  angle: 0
});
three_min_btn.visible = false;
three_min_btn.hasControls = three_min_btn.hasBorders = false;
three_min_btn.lockMovementX = three_min_btn.lockMovementY = true;
three_min_btn.id = 'three_min_btn';

var three_min_btn_text = new fabric.IText('3 min', {
  fontFamily: 'arial black',
  fontSize: 25,
  left: 237,
  top: 465,
  width: 60,
  height: 50
});
three_min_btn_text.visible = false;
three_min_btn_text.hasControls = three_min_btn_text.hasBorders = false;
three_min_btn_text.lockMovementX = three_min_btn_text.lockMovementY = true;
three_min_btn_text.id = 'three_min_btn_text';

ArrayOfObjects.push(three_min_btn_text);
ArrayOfObjects.push(three_min_btn);

var five_min_btn = new fabric.Rect({
  left: 350,
  top: 450,
  fill: 'light-gray',
  stroke: 'black',
  strokeWidth: 4,
  width: 95,
  height: 60,
  angle: 0
});
five_min_btn.visible = false;
five_min_btn.hasControls = five_min_btn.hasBorders = false;
five_min_btn.lockMovementX = five_min_btn.lockMovementY = true;
five_min_btn.id = 'five_min_btn';

var five_min_btn_text = new fabric.IText('5 min', {
  fontFamily: 'arial black',
  fontSize: 25,
  left: 357,
  top: 465,
  width: 60,
  height: 50
});
five_min_btn_text.visible = false;
five_min_btn_text.hasControls = five_min_btn_text.hasBorders = false;
five_min_btn_text.lockMovementX = five_min_btn_text.lockMovementY = true;
five_min_btn_text.id = 'five_min_btn_text';

ArrayOfObjects.push(five_min_btn);
ArrayOfObjects.push(five_min_btn_text);

//********************************************************************************************


var doorbell_save_btn = new fabric.Rect({
  left: 290,
  top: 470,
  fill: 'light-gray',
  stroke: 'green',
  strokeWidth: 2,
  width: 80,
  height: 30,
  angle: 0
});
doorbell_save_btn.visible = false;
doorbell_save_btn.hasControls = doorbell_save_btn.hasBorders = false;
doorbell_save_btn.lockMovementX = doorbell_save_btn.lockMovementY = true;
doorbell_save_btn.id = 'doorbell_save_btn';

var doorbell_save_btn_text = new fabric.IText('Save', {
  fontFamily: 'Calibri',
  fontSize: 20,
  left: 300,
  top: 475 ,
  width: 65,
  height: 46
});
doorbell_save_btn_text.visible = false;
doorbell_save_btn_text.hasControls = doorbell_save_btn_text.hasBorders = false;
doorbell_save_btn_text.lockMovementX = doorbell_save_btn_text.lockMovementY = true;
doorbell_save_btn_text.id = 'doorbell_save_btn_text';

ArrayOfObjects.push(doorbell_save_btn);
ArrayOfObjects.push(doorbell_save_btn_text);

var doorbell_cancel_btn = new fabric.Rect({
  left: 180,
  top: 470,
  fill: 'light-gray',
  stroke: 'red',
  strokeWidth: 2,
  width: 80,
  height: 30,
  angle: 0
});
doorbell_cancel_btn.visible = false;
doorbell_cancel_btn.hasControls = doorbell_cancel_btn.hasBorders = false;
doorbell_cancel_btn.lockMovementX = doorbell_cancel_btn.lockMovementY = true;
doorbell_cancel_btn.id = 'doorbell_cancel_btn';

var doorbell_cancel_btn_text = new fabric.IText('Cancel', {
  fontFamily: 'Calibri',
  fontSize: 20,
  left: 185,
  top: 475 ,
  width: 65,
  height: 46
});
doorbell_cancel_btn_text.visible = false;
doorbell_cancel_btn_text.hasControls = doorbell_cancel_btn_text.hasBorders = false;
doorbell_cancel_btn_text.lockMovementX = doorbell_cancel_btn_text.lockMovementY = true;
doorbell_cancel_btn_text.id = 'doorbell_cancel_btn_text';

ArrayOfObjects.push(doorbell_cancel_btn_text);
ArrayOfObjects.push(doorbell_cancel_btn);

var doorbell_mute_option = new fabric.Rect({
  left: 180,
  top: 320,
  fill: 'light-gray',
  stroke: 'black',
  strokeWidth: 3,
  width: 190,
  height: 40,
  angle: 0
});
doorbell_mute_option.visible = false;
doorbell_mute_option.hasControls = doorbell_mute_option.hasBorders = false;
doorbell_mute_option.lockMovementX = doorbell_mute_option.lockMovementY = true;
doorbell_mute_option.id = 'doorbell_mute_option';

var doorbell_mute_option_text = new fabric.IText('Mute', {
  fontFamily: 'Calibri',
  fontSize: 20,
  left: 200,
  top: 330,
  width: 65,
  height: 46
});
doorbell_mute_option_text.visible = false;
doorbell_mute_option_text.hasControls = doorbell_mute_option_text.hasBorders = false;
doorbell_mute_option_text.lockMovementX = doorbell_mute_option_text.lockMovementY = true;
doorbell_mute_option_text.id = 'doorbell_mute_option_text';

ArrayOfObjects.push(doorbell_mute_option_text);
ArrayOfObjects.push(doorbell_mute_option);

var doorbell_ding_option = new fabric.Rect({
  left: 180,
  top: 370,
  fill: 'light-gray',
  stroke: 'blue',
  strokeWidth: 3,
  width: 190,
  height: 40,
  angle: 0
});
doorbell_ding_option.visible = false;
doorbell_ding_option.hasControls = doorbell_ding_option.hasBorders = false;
doorbell_ding_option.lockMovementX = doorbell_ding_option.lockMovementY = true;
doorbell_ding_option.id = 'doorbell_ding_option';

var doorbell_ding_option_text = new fabric.IText('Ding', {
  fontFamily: 'Calibri',
  fontSize:20,
  left: 200,
  top: 380,
  width: 65,
  height: 46
});
doorbell_ding_option_text.visible = false;
doorbell_ding_option_text.hasControls = doorbell_ding_option_text.hasBorders = false;
doorbell_ding_option_text.lockMovementX = doorbell_ding_option_text.lockMovementY = true;
doorbell_ding_option_text.id = 'doorbell_ding_option_text';

ArrayOfObjects.push(doorbell_ding_option);
ArrayOfObjects.push(doorbell_ding_option_text);

var doorbell_dingdong_option = new fabric.Rect({
  left: 180,
  top: 420,
  fill: 'light-gray',
  stroke: 'black',
  strokeWidth: 3,
  width: 190,
  height: 40,
  angle: 0
});
doorbell_dingdong_option.visible = false;
doorbell_dingdong_option.hasControls = doorbell_dingdong_option.hasBorders = false;
doorbell_dingdong_option.lockMovementX = doorbell_dingdong_option.lockMovementY = true;
doorbell_dingdong_option.id = 'doorbell_dingdong_option';

var doorbell_dingdong_option_text = new fabric.IText('Ding-Dong', {
  fontFamily: 'Calibri',
  fontSize: 20,
  left: 200,
  top: 430,
  width: 65,
  height: 46
});
doorbell_dingdong_option_text.visible = false;
doorbell_dingdong_option_text.hasControls = doorbell_dingdong_option_text.hasBorders = false;
doorbell_dingdong_option_text.lockMovementX = doorbell_dingdong_option_text.lockMovementY = true;
doorbell_dingdong_option_text.id = 'doorbell_dingdong_option_text';

ArrayOfObjects.push(doorbell_dingdong_option_text);
ArrayOfObjects.push(doorbell_dingdong_option);




//********************************************************************************************

var icon_restart;
fabric.Image.fromURL('images/restart.png', function(oImg) {
  oImg.set({left: 550, top: 1150, id: this.id});
  oImg.visible = false;
  oImg.hasControls = oImg.hasBorders = false;
  oImg.lockMovementY = oImg.lockMovementX = true;
  oImg.id = 'restart';
  icon_restart = oImg;
  ArrayOfObjects.push(icon_restart);
  canvas.add(icon_restart);
});

fabric.Image.fromURL('images/alarmOn.gif', function(oImg) {
  oImg.set({left: 549, top: 920, id: this.id});
  oImg.visible = false;
  oImg.hasControls = oImg.hasBorders = false;
  oImg.lockMovementY = oImg.lockMovementX = true;
  oImg.id = 'alarmOn';
  ArrayOfObjects.push(oImg);
  canvas.add(oImg);

});

//----------------------- Camera Components ---------------------------
var AvatarOut = new fabric.Rect({
  left: 830,
  top: 250,
  //fill: 'grey',
  stroke: 'black',
  width: 200,
  height: 200,
  angle: 0
});
AvatarOut.visible = false;
AvatarOut.hasControls = AvatarOut.hasBorders = AvatarOut.selectable = false;
AvatarOut.lockMovementX = AvatarOut.lockMovementY = true;

fabric.util.loadImage('images/AvatarOnOut.gif', function (img) {
  AvatarOut.setPatternFill({
    source: img,
    repeat: 'repeat'
  });
});
ArrayOfObjects.push(AvatarOut);

var CameraIn = new fabric.Rect({
  left: 100,
  top: 320,
  stroke: 'black',
  width: 100,
  height: 100,
  angle: 0
});
CameraIn.visible = false;
CameraIn.hasControls = CameraIn.hasBorders = CameraIn.selectable = false;
CameraIn.lockMovementX = CameraIn.lockMovementY = true;

fabric.util.loadImage('images/AvatarIn.gif', function (img) {
  CameraIn.setPatternFill({
    source: img,
    repeat: 'repeat'
  });
});
ArrayOfObjects.push(CameraIn);

AvatarOnOff = new fabric.Rect({
  left: 210,
  top: 320,
  stroke: 'black',
  width: 40,
  height: 40,
  angle: 0
});
AvatarOnOff.visible = false;
AvatarOnOff.hasControls = AvatarOnOff.hasBorders = false;
AvatarOnOff.lockMovementX = AvatarOnOff.lockMovementY = true;

fabric.util.loadImage('images/AvatarOn.gif', function (img) {
  AvatarOnOff.setPatternFill({
    source: img,
    repeat: 'repeat'
  });
});
ArrayOfObjects.push(AvatarOnOff);

LiveOnOff = new fabric.Rect({
  left: 210,
  top: 380,
  stroke: 'black',
  width: 40,
  height: 40,
  angle: 0
});
LiveOnOff.visible = false;
LiveOnOff.hasControls = LiveOnOff.hasBorders = false;
LiveOnOff.lockMovementX = LiveOnOff.lockMovementY = true;

fabric.util.loadImage('images/LiveOn.gif', function (img) {
  LiveOnOff.setPatternFill({
    source: img,
    repeat: 'repeat'
  });
});
ArrayOfObjects.push(LiveOnOff);
//------------------------------------------------------------------
var icon_doorbell;
fabric.Image.fromURL('images/doorbell.gif', function(oImg) {
  oImg.set({left: 1485, top: 680, id: this.id});
  oImg.visible = false;
  oImg.hasControls = oImg.hasBorders = false;
  oImg.lockMovementY = oImg.lockMovementX = true;
  oImg.id = 'doorbell';
  icon_doorbell = oImg;
  canvas.add(oImg);
});

var icon_write_messages;
fabric.Image.fromURL('images/writemsg.gif', function(oImg) {
  oImg.set({left: 1470, top: 790, id: this.id});
  oImg.visible = false;
  oImg.hasControls = oImg.hasBorders = false;
  oImg.lockMovementY = oImg.lockMovementX = true;
  oImg.id = 'writemsg';
  icon_write_messages = oImg;
  canvas.add(icon_write_messages);
});

var icon_number_pad;
fabric.Image.fromURL('images/numberpad.gif', function(oImg) {
  oImg.set({left: 1480, top: 860, id: this.id});
  oImg.visible = false;
  oImg.hasControls = oImg.hasBorders = false;
  oImg.lockMovementY = oImg.lockMovementX = true;
  oImg.id = 'numberpad';
  icon_number_pad = oImg;
  canvas.add(icon_number_pad);
});

//------------------------------- Themes components --------------------------------
//----------------------------------------------------------------------------------
var ActiveSide = "Inside";

var InsideText = new fabric.Text("Inside", {
  left: 180,
  top: 330,
  fontFamily: 'Times',
  fontSize: 25,
  opacity: 1
});
InsideText.setColor('black');
InsideText.selectable = true;
InsideText.visible = false;
InsideText.hasControls = InsideText.hasBorders = false;
InsideText.lockMovementX = InsideText.lockMovementY = true;
ArrayOfObjects.push(InsideText);


var OutsideText = new fabric.Text("Outside", {
  left: 310,
  top: 330,
  fontFamily: 'Times',
  fontSize: 25,
  opacity: 0.3
});
OutsideText.setColor('black');
OutsideText.selectable = true;
OutsideText.visible = false;
OutsideText.hasControls = OutsideText.hasBorders = false;
OutsideText.lockMovementX = OutsideText.lockMovementY = true;
ArrayOfObjects.push(OutsideText);

var ThemesDroplist = new fabric.Text('  Themes         ', {
  backgroundColor: 'lightgrey',
  borderColor: 'black',
  fontFamily: 'Times',
  fontSize: 23,
  padding: 5,
  left: 135,
  top: 365 ,
  width: 150,
  height: 50
});
ThemesDroplist.selectable = true;
ThemesDroplist.visible = false;
ThemesDroplist.hasBorders = true;
ThemesDroplist.hasControls =  false;
ThemesDroplist.lockMovementX = ThemesDroplist.lockMovementY = true;
ArrayOfObjects.push(ThemesDroplist);


var OrnamentDroplist = new fabric.Text('  Ornaments    ', {
  backgroundColor: 'lightgrey',
  borderColor: 'black',
  fontFamily: 'Times',
  fontSize: 23,
  padding: 5,
  left: 285,
  top: 365 ,
  width: 150,
  height: 50
});
OrnamentDroplist.selectable = true;
OrnamentDroplist.visible = false;
OrnamentDroplist.hasBorders = true;
OrnamentDroplist.hasControls =  false;
OrnamentDroplist.lockMovementX = OrnamentDroplist.lockMovementY = true;
ArrayOfObjects.push(OrnamentDroplist);


var WoodText = new fabric.Text('  Wood            ', {
  backgroundColor: 'white',
  fontFamily: 'Times',
  fontSize: 23,
  padding: 5,
  left: 135,
  top: 400 ,
  width: 150,
  height: 50
});
WoodText.selectable = true;
WoodText.visible = false;
WoodText.hasBorders = false;
WoodText.hasControls =  false;
WoodText.lockMovementX = WoodText.lockMovementY = true;
ArrayOfObjects.push(WoodText);

var MetalText = new fabric.Text('  Metal            ', {
  backgroundColor: 'white',
  fontFamily: 'Times',
  fontSize: 23,
  padding: 5,
  left: 135,
  top: 430 ,
  width: 150,
  height: 50
});
MetalText.selectable = true;
MetalText.visible = false;
MetalText.hasBorders = false;
MetalText.hasControls =  false;
MetalText.lockMovementX = MetalText.lockMovementY = true;
ArrayOfObjects.push(MetalText);

var XmassText = new fabric.Text('  Xmass           ', {
  backgroundColor: 'white',
  fontFamily: 'Times',
  fontSize: 23,
  padding: 5,
  left: 285,
  top: 400 ,
  width: 150,
  height: 50
});
XmassText.selectable = true;
XmassText.visible = false;
XmassText.hasBorders = false;
XmassText.hasControls =  false;
XmassText.lockMovementX = XmassText.lockMovementY = true;
ArrayOfObjects.push(XmassText);

var EasterText = new fabric.Text('  Easter            ', {
  backgroundColor: 'white',
  fontFamily: 'Times',
  fontSize: 23,
  padding: 5,
  left: 285,
  top: 430 ,
  width: 150,
  height: 50
});
EasterText.selectable = true;
EasterText.visible = false;
EasterText.hasBorders = false;
EasterText.hasControls =  false;
EasterText.lockMovementX = EasterText.lockMovementY = true;
ArrayOfObjects.push(EasterText);

var ResetTheme = new fabric.Text('  Reset  ', {
  backgroundColor: 'lightgrey',
  fontFamily: 'Times',
  fontSize: 23,
  padding: 5,
  left: 235,
  top: 470 ,
  width: 150,
  height: 50
});
ResetTheme.selectable = true;
ResetTheme.visible = false;
ResetTheme.hasBorders = false;
ResetTheme.hasControls =  false;
ResetTheme.lockMovementX = ResetTheme.lockMovementY = true;
ArrayOfObjects.push(ResetTheme);

var EasterOrn;
fabric.Image.fromURL('images/easter.gif', function(oImg) {
  oImg.set({left: 1750, top: 100, id: this.id});
  oImg.visible = false;
  oImg.scale(1.1);
  oImg.hasControls = oImg.hasBorders = false;
  oImg.lockMovementY = oImg.lockMovementX = true;
  oImg.id = 'easter';
  EasterOrn = oImg;
  canvas.add(EasterOrn);
});

var XmassOrn;
fabric.Image.fromURL('images/xmass.gif', function(oImg) {
  oImg.set({left: 1750, top: 100, id: this.id});
  oImg.visible = false;
  oImg.scale(1.1);
  oImg.hasControls = oImg.hasBorders = false;
  oImg.lockMovementY = oImg.lockMovementX = true;
  oImg.id = 'easter';
  XmassOrn = oImg;
  canvas.add(XmassOrn);
});

//---------------------- theme function -----------------------
function ShowThemeSettings()
{
  InsideText.visible = true;
  OutsideText.visible = true;
  ThemesDroplist.visible = true;
  OrnamentDroplist.visible = true;
  WoodText.visible = true;
  MetalText.visible = true;
  XmassText.visible = true;
  EasterText.visible = true;
  ResetTheme.visible = true;
  WoodText.backgroundColor = 'white';
  MetalText.backgroundColor = 'white';
  XmassText.backgroundColor = 'white';
  EasterText.backgroundColor = 'white';
}

function CloseThemeSettings()
{
  InsideText.visible = false;
  OutsideText.visible = false;
  ThemesDroplist.visible = false;
  OrnamentDroplist.visible = false;
  WoodText.visible = false;
  MetalText.visible = false;
  XmassText.visible = false;
  EasterText.visible = false;
  ResetTheme.visible = false;
}

InsideText.on('mousedown', function ()
{
  WoodText.backgroundColor = 'white';
  MetalText.backgroundColor = 'white';
  XmassText.backgroundColor = 'white';
  EasterText.backgroundColor = 'white';
  InsideText.setOpacity(1);
  OutsideText.setOpacity(0.3);
  ActiveSide = "Inside";
});

OutsideText.on('mousedown', function ()
{
  WoodText.backgroundColor = 'white';
  MetalText.backgroundColor = 'white';
  XmassText.backgroundColor = 'white';
  EasterText.backgroundColor = 'white';
  InsideText.setOpacity(0.3);
  OutsideText.setOpacity(1);
  ActiveSide = "Outside";
});
//------------
WoodText.on('mousedown', function ()
{
  MetalText.backgroundColor = 'white';
  WoodText.backgroundColor = '#85C1E9';

  if(ActiveSide == "Inside"){
      In_theme = 'Wood';
      CURRENT_USER.in_theme = In_theme;
      fabric.util.loadImage('images/wooddoor.jpg', function (img) {
        img.id = 'Wood';
        insideDoor.setPatternFill({
          source: img,
          repeat: 'repeat'
        });
      });
  }

  else if(ActiveSide == "Outside"){
      Out_theme = 'Wood';
      CURRENT_USER.out_theme = Out_theme;
      fabric.util.loadImage('images/wooddoor.jpg', function (img) {
        img.id = 'Wood';
        outsideDoor.setPatternFill({
          source: img,
          repeat: 'repeat'
        });
      });
    }
});

//------------
MetalText.on('mousedown', function (){
  MetalText.backgroundColor = '#85C1E9';
  WoodText.backgroundColor = 'white';
  if(ActiveSide == "Inside"){
    In_theme = 'Metal';
    CURRENT_USER.in_theme = In_theme;
    fabric.util.loadImage('images/metal.jpg', function (img) {
      img.id = 'Metal';
      insideDoor.setPatternFill({
        source: img,
        repeat: 'repeat'
      });
    });
  }
  else if(ActiveSide == "Outside"){
    Out_theme = 'Metal';
    CURRENT_USER.out_theme = Out_theme;
    fabric.util.loadImage('images/metal.jpg', function (img) {
      img.id = 'Metal';
      outsideDoor.setPatternFill({
        source: img,
        repeat: 'repeat'
      });
    });
  }
});

//----------------
XmassText.on('mousedown', function (){
  Out_ornament = 'Xmass';
  CURRENT_USER.out_ornament = Out_ornament;
  XmassText.backgroundColor = '#85C1E9';
  EasterText.backgroundColor = 'white';
  XmassOrn.visible = true;
  EasterOrn.visible = false;
});

EasterText.on('mousedown', function () {
  Out_ornament = 'Easter';
  CURRENT_USER.out_ornament = Out_ornament;
  XmassText.backgroundColor = 'white';
  EasterText.backgroundColor = '#85C1E9';
  XmassOrn.visible = false;
  EasterOrn.visible = true;
});

//----------
ResetTheme.on('mousedown', function (){
  In_theme = 'default';
  Out_theme = 'default';
  Out_ornament = 'default';

  CURRENT_USER.out_theme = Out_theme;
  CURRENT_USER.in_theme = In_theme;
  CURRENT_USER.out_ornament = Out_ornament;
  XmassOrn.visible = false;
  EasterOrn.visible = false;

  fabric.util.loadImage('images/Doorpattern.gif', function (img) {
    insideDoor.setPatternFill({
      source: img,
      repeat: 'repeat'
    });
  });

  fabric.util.loadImage('images/DoorpatternOut.gif', function (img) {
      outsideDoor.setPatternFill({
      source: img,
      repeat: 'repeat'
      });
  });
});

//********************************************************************************************
function init_traffic_stuff() {


}

function getObjectWithId(id) {
  for (var i = 0; i < canvas.getObjects().length; ++i){
    if (canvas.item(i).id == id) {
      console.log(id);
      return canvas.item(i);
    }
  }
}

//********************************************************************************************
//------------------------------ User settings components and function ----------------
var UserSettingList; //Just a panel
fabric.Image.fromURL('images/Usersettinglist.jpg', function(oImg) {
  oImg.set({left: 365, top: 690, id: this.id});
  oImg.visible = false;
  oImg.hasControls = oImg.hasBorders = false;
  oImg.lockMovementY = oImg.lockMovementX = true;
  oImg.id = 'Usersettinglist';
  UserSettingList = oImg;
  canvas.add(UserSettingList);
  ArrayOfObjects.push(UserSettingList);
});



var UserFName = new fabric.Text('', {
    fontFamily: 'Times',
    fontSize: 50,
    left: 400,
    top: 800,
    });
UserFName.selectable = true;
UserFName.visible = true;
UserFName.hasBorders = false;
UserFName.hasControls =  false;
UserFName.lockMovementX = UserFName.lockMovementY = true;
ArrayOfObjects.push(UserFName);


var UserLName = new fabric.Text('', {
    fontFamily: 'Times',
    fontSize: 50,
    left: 400,
    top: 850,
    });
UserLName.selectable = true;
UserLName.visible = true;
UserLName.hasBorders = false;
UserLName.hasControls =  false;
UserLName.lockMovementX = UserLName.lockMovementY = true;
ArrayOfObjects.push(UserLName);



var UserLang = new fabric.Text('', {
    fontFamily: 'Times',
    fontSize: 50,
    left: 400,
    top: 900,
    });
UserLang.selectable = true;
UserLang.visible = true;
UserLang.hasBorders = false;
UserLang.hasControls =  false;
UserLang.lockMovementX = UserLang.lockMovementY = true;
ArrayOfObjects.push(UserLang);



var UserTimeFormat = new fabric.Text('', {
    fontFamily: 'Times',
    fontSize: 50,
    left: 400,
    top: 950,
    });
UserTimeFormat.selectable = true;
UserTimeFormat.visible = true;
UserTimeFormat.hasBorders = false;
UserTimeFormat.hasControls =  false;
UserTimeFormat.lockMovementX = UserTimeFormat.lockMovementY = true;
ArrayOfObjects.push(UserTimeFormat);



var UserDateFormat = new fabric.Text('', {
    fontFamily: 'Times',
    fontSize: 50,
    left: 400,
    top: 1000,
    });
UserDateFormat.selectable = true;
UserDateFormat.visible = true;
UserDateFormat.hasBorders = false;
UserDateFormat.hasControls =  false;
UserDateFormat.lockMovementX = UserDateFormat.lockMovementY = true;
ArrayOfObjects.push(UserDateFormat);


var BackButtFromUSerData = new fabric.Text('Back', {
    fontFamily: 'Times',
    background: 'darkgrey',
    fontSize: 60,
    left: 550,
    top: 1080,
    });
BackButtFromUSerData.selectable = true;
BackButtFromUSerData.visible = true;
BackButtFromUSerData.hasBorders = false;
BackButtFromUSerData.hasControls =  false;
BackButtFromUSerData.lockMovementX = BackButtFromUSerData.lockMovementY = true;
ArrayOfObjects.push(BackButtFromUSerData);

BackButtFromUSerData.on('selected', function()
  {
    HideUserData();
    //ShowUserSettings();
    for (i = 0; i < UsersNames.length; i++) {
    UsersNames[i].visible = true;
  }
  });

var UserSettingMsg = new fabric.Text(' Not Allowed to Adjust Settings', {
    fontFamily: 'Times',
    background: 'darkgrey',
    fontSize: 60,
    left: 450,
    top: 1050,
    });
UserSettingMsg.selectable = false;
UserSettingMsg.visible = false;
UserSettingMsg.hasBorders = false;
UserSettingMsg.hasControls =  false;
UserSettingMsg.lockMovementX = UserSettingMsg.lockMovementY = true;
ArrayOfObjects.push(UserSettingMsg);



//console.log( "My array length b: "+ArrayOfObjects.length);

function ShowUserSettings(){
  mBackButton.addToBackStack(showSettings,HideUserData);
  UsersNames = [];
  UserSettingList.visible = true;
  //UserSettingMsg.visible = false;
  //loop to get names and add them to canvas
  for (i = 0; i < RegisteredUsers.length; i++){
    var topv = 730 + (70*(i+1)/(i+1)) * (i+1);
    var UserName = new fabric.Text('', {
      fontFamily: 'Times',
      fontSize: 60,
      left: 400,
      top: topv,
    });

    UserName.setText(RegisteredUsers.at(i).firstname);
    if(CURRENT_USER.id == RegisteredUsers.at(i).id)
      UserName.selectable = true;
    else{
      UserName.selectable = false;
      UserName.opacity = 0.3;
    }

    canvas.add(UserName);
    UserName.bringForward();
    UsersNames.push(UserName);
    ArrayOfObjects.push(UsersNames[i]);
  }

  console.log("We are : "+ UsersNames.length);
  console.log("here : "+ UsersNames[1].top);
  console.log( "My array length a: " + ArrayOfObjects.length);


  for (i = 0; i < UsersNames.length; i++) {
    UsersNames[i].id = i;
  }
}

function HideUserSettings(){
  UserSettingList.visible = false;
  for (i = 0; i < UsersNames.length; i++) {
    UsersNames[i].visible = false;
  }
}



//********************************************************************************************
//------------------------------ Volume ----------------

  var panelleft = 72 + 20;
  var paneltop= 335;
  var panelwidth = 410 - 40;
  var panelheight = 150;

var volumepanel = new fabric.Rect({
  left: panelleft,
  top: paneltop,
  fill: 'lightgrey',
  stroke: 'darkgrey',
  width: panelwidth,
  height: panelheight,
  angle: 0
});
volumepanel.visible = false;
volumepanel.hasControls = volumepanel.hasBorders = volumepanel.selectable = false;
volumepanel.lockMovementX = volumepanel.lockMovementY = true;


var volumebar = new fabric.Rect({
  left: panelleft + 50,
  top: paneltop + 64,
  fill: '#656565',
  stroke: 'darkgrey',
  width: panelwidth - 100,
  height: 20,
  angle: 0
});
volumebar.visible = false;
volumebar.hasControls = volumebar.hasBorders = volumebar.selectable = false;
volumebar.lockMovementX = volumebar.lockMovementY = true;

var volumeslider = new fabric.Rect( {
  left: 591 / 2.22,
  top: paneltop + 50,
  fill: 'white',
  stroke: 'darkgrey',
  width: 20,
  height: 50,
  angle: 0
});
volumeslider.visible = false;
volumeslider.hasControls = volumeslider.hasBorders = false;
volumeslider.lockMovementY = true;

ArrayOfObjects.push(volumepanel);
ArrayOfObjects.push(volumebar);
ArrayOfObjects.push(volumeslider);

var VolumeSettingsText = FabricText(VOLUME[syslang],235,350,24);
var volumePercentage = FabricText("0%",260, 450, 20);
ArrayOfObjects.push( VolumeSettingsText );
ArrayOfObjects.push( volumePercentage  );
  
var vpercent;
var left;
canvas.on("object:moving", function(e) {
  var activeObject = e.target;
  if (activeObject.id == "slider") {
    update_brightness(activeObject.left/(slider_back.left + (slider_back.width*2)));
    if (activeObject.left <= slider_back.left) {
      activeObject.left = slider_back.left
    }
    else if ( activeObject.left >= ( slider_back.left + (slider_back.width*2))) {
      activeObject.left = slider_back.left + (slider_back.width*2);
    }
  } 
  else {
    var leftBound = volumebar.left;
    var widthdiff = volumebar.width*2.22 - volumeslider.width*2.22
    var rightBound = leftBound + widthdiff;
    volumeslider.setLeft( Math.min( Math.max(volumeslider.left, leftBound) , rightBound));
    left = volumeslider.left;
    vpercent = ((volumeslider.left - leftBound) * 100 / widthdiff).toFixed(0);
    volumePercentage.text =  "" + vpercent + "%";
  } 
//  console.log(vpercent);
//  console.log(left);
});

canvas.on("mouse:up", function (object) {
//  console.log(object.target);
  if(object.target == volumeslider && CURRENT_USER != null) {
    CURRENT_USER.vpercent = vpercent;
    CURRENT_USER.sliderleft = left;
  }
});



//********************************************************************************************
// Back Button

var backbutton = null;
fabric.Image.fromURL('images/backbutton.png', function(oImg) {
  oImg.set({left: 550, top: 1155, id: this.id});
  oImg.visible = false;
  oImg.hasControls = oImg.hasBorders = false;
  oImg.lockMovementY = oImg.lockMovementX = true;
  oImg.id = 'backbutton';
  oImg.scaleX = 0.5;
  oImg.scaleY = 0.5;
  canvas.add(oImg);
  ArrayOfObjects.push(oImg);
});


function BackButton() {
  this.hidefunctions = [];
  this.howigothere = [];

  this.addToBackStack = function( returnTo, hidefunction){
    this.hidefunctions.push(hidefunction);
    this.howigothere.push(returnTo);
    console.log(returnTo.name);
    console.log(hidefunction.name);
  }

  this.goBack = function() {
    var hide = this.hidefunctions.pop();
    var returnto = this.howigothere.pop();
    hide();
    returnto();
  }
}
var mBackButton = new BackButton();


function ShowUserData(id){
  HideUserSettings();
  UserSettingList.visible = true;
  UserFName.setText(RegisteredUsers.at(id).firstname);
  canvas.add(UserFName);
  UserLName.setText(RegisteredUsers.at(id).lastname);
  canvas.add(UserLName);

  UserTimeFormat.setText(RegisteredUsers.at(id).time_format);
  canvas.add(UserTimeFormat);

  UserDateFormat.setText(RegisteredUsers.at(id).date_format);
  canvas.add(UserDateFormat);
  UserLang.setText(SYSTEM_LANGUAGE[RegisteredUsers.at(id).language]);

  canvas.add(UserLang);

  canvas.add(BackButtFromUSerData);
}

function HideUserData(){
  //UserSettingList.visible = false;
  //UserFName.setText(RegisteredUsers.at(id).firstname);
  canvas.remove(UserFName);
 // UserLName.setText(RegisteredUsers.at(id).lastname);
  canvas.remove(UserLName);

  //UserTimeFormat.setText(RegisteredUsers.at(id).time_format);
  canvas.remove(UserTimeFormat);

 // UserDateFormat.setText(RegisteredUsers.at(id).date_format);
  canvas.remove(UserDateFormat);

  canvas.remove(UserLang);
  canvas.remove(BackButtFromUSerData);
  //canvas.renderAll();
}

//----------------------------- 911 -------------------------------------------
var Panel911;
fabric.Image.fromURL('images/calling911.jpg', function(oImg) {
  oImg.set({left: 420, top: 690, id: this.id});
  oImg.visible = false;
  //oImg.scale(1.1);
  oImg.hasControls = oImg.hasBorders = false;
  oImg.lockMovementY = oImg.lockMovementX = true;
  oImg.selectable = false;
  oImg.id = '911Panel';
  Panel911 = oImg;
  ArrayOfObjects.push(Panel911);
  canvas.add(Panel911);
});

var CancelEmergency;
fabric.Image.fromURL('images/cancel911.jpg', function(oImg) {
  oImg.set({left: 488, top: 845, id: this.id});
  oImg.visible = false;
  //oImg.scale(1.1);
  oImg.hasControls = oImg.hasBorders = false;
  oImg.lockMovementY = oImg.lockMovementX = true;
  oImg.selectable = true;
  oImg.id = 'CancelEmergency';
  CancelEmergency = oImg;
  ArrayOfObjects.push(CancelEmergency);
  canvas.add(CancelEmergency);
});

var CancelEmergency2;
fabric.Image.fromURL('images/cancel911.jpg', function(oImg) {
  oImg.set({left: 488, top: 943, id: this.id});
  oImg.visible = false;
  //oImg.scale(1.1);
  oImg.hasControls = oImg.hasBorders = false;
  oImg.lockMovementY = oImg.lockMovementX = true;
  oImg.selectable = true;
  oImg.id = 'CancelEmergency2';
  CancelEmergency2 = oImg;
  ArrayOfObjects.push(CancelEmergency2);
  canvas.add(CancelEmergency2);
});

var YesEmergency;
fabric.Image.fromURL('images/yes911.jpg', function(oImg) {
  oImg.set({left: 488, top: 943, id: this.id});
  oImg.visible = false;
  oImg.hasControls = oImg.hasBorders = false;
  oImg.lockMovementY = oImg.lockMovementX = true;
  oImg.selectable = true;
  oImg.id = 'YesEmergency';
  YesEmergency = oImg;
  ArrayOfObjects.push(YesEmergency);
  canvas.add(YesEmergency);
});

var CallingOn;
fabric.Image.fromURL('images/911call.gif', function(oImg) {
  oImg.set({left: 510, top: 743, id: this.id});
  oImg.visible = false;
  oImg.scale(0.5);
  oImg.hasControls = oImg.hasBorders = false;
  oImg.lockMovementY = oImg.lockMovementX = true;
  oImg.selectable = true;
  oImg.id = 'CallingOn';
  CallingOn = oImg;
  ArrayOfObjects.push(CallingOn);
  canvas.add(CallingOn);
});




function Show911()
{
  Panel911.visible = true;
  CancelEmergency.visible = true;
  YesEmergency.visible = true;

}
function Hide911()
{
  Panel911.visible = false;
  CancelEmergency.visible = false;
  CancelEmergency2.visible = false;
  YesEmergency.visible = false;
  CallingOn.visible = false
}

function Run911Call()
{
  //Panel911.visible = false;
  //CancelEmergency.visible = false;
  //YesEmergency.visible = false;
  CancelEmergency2.visible = true;
  CallingOn.visible = true


}
// ------------------- vidoe tutorial ----------------

var VideoPanel = new fabric.Rect({
  left: 148,
  top: 310,
  fill: 'darkgrey',
  //stroke: 'darkgrey',
  width: 253,
  height: 205,
  angle: 0
});
VideoPanel.visible = false;
VideoPanel.hasControls = VideoPanel.hasBorders = VideoPanel.selectable = false;
VideoPanel.lockMovementX = VideoPanel.lockMovementY = true;

//fabric.util.loadImage('images/videoBackground.jpg', function (img) {
  //VideoPanel.setPatternFill({
    //source: img,
  //  repeat: 'repeat'
 // });
//});

ArrayOfObjects.push(VideoPanel);


var VideoElement1 = document.getElementById('video1');
var video1 = new fabric.Image(VideoElement1, {
  left: 150,
  top: 312,
  width: 250,
  height: 200,
});
video1.visible = false;
video1.hasControls = video1.hasBorders = video1.selectable = false;
video1.lockMovementX = video1.lockMovementY = true;

fabric.Image.fromURL('images/play.gif', function(oImg) {
  oImg.set({left: 547, top: 1152, borderColor: 'silver', id: this.id});
  oImg.hasControls = false;
  oImg.hasBorders = false;
  oImg.lockMovementY = true;
  oImg.lockMovementX = true;
  oImg.visible = false;
  oImg.scale(0.55);
  oImg.id = 'play';
  canvas.add(oImg);
  });

fabric.Image.fromURL('images/pause.gif', function(oImg) {
  oImg.set({left: 547, top: 1152, borderColor: 'silver', id: this.id});
  oImg.hasControls = false;
  oImg.hasBorders = false;
  oImg.lockMovementY = true;
  oImg.lockMovementX = true;
  oImg.visible = false;
  oImg.scale(0.55);
  oImg.id = 'pause';
  canvas.add(oImg);
  });




function ShowVideoTour()
{
  hideSettings();
  video1.visible = true;
  VideoPanel.visible = true;
  for (var i = 0; i < canvas.getObjects().length; ++i)
  {
    if (canvas.item(i).id == 'play')
    {
      canvas.item(i).visible = true;
    }


  }

}

function HideVideoTour()
{
  video1.visible = false;
  VideoPanel.visible = false;
  for (var i = 0; i < canvas.getObjects().length; ++i)
  {
    if (canvas.item(i).id == 'play' || canvas.item(i).id == 'pause' )
    {
      canvas.item(i).visible = false;
    }

  }

}

function play()
{
  video1.getElement().play();

  for (var i = 0; i < canvas.getObjects().length; ++i)
  {
    if (canvas.item(i).id == 'play')
    {
      canvas.item(i).visible = false;
    }
    else if (canvas.item(i).id == 'pause')
    {
      canvas.item(i).visible = true;
    }


  }
}

function pause()
{
  video1.getElement().pause();
  for (var i = 0; i < canvas.getObjects().length; ++i)
  {
    if (canvas.item(i).id == 'pause')
    {
      canvas.item(i).visible = false;
    }
    else if (canvas.item(i).id == 'play')
    {
      canvas.item(i).visible = true;
    }


  }
}
//----------------------- All components for Language settings -------------------------

var LangaugePanel = new fabric.Rect({
  left: 72,
  top: 310,
  fill: 'lightgrey',
  //stroke: 'darkgrey',
  width: 410,
  height: 200,
  angle: 0
});
LangaugePanel.visible = false;
LangaugePanel.hasControls = LangaugePanel.hasBorders = LangaugePanel.selectable = false;
LangaugePanel.lockMovementX = LangaugePanel.lockMovementY = true;

fabric.util.loadImage('images/LangBackground.jpg', function (img) {
  LangaugePanel.setPatternFill({
    source: img,
    repeat: 'repeat'
  });
});

ArrayOfObjects.push(LangaugePanel);
//++++++++++++++++++++++++++++
var EnglishLang = new fabric.Text('English', {
  left: 100,
  top: 380,
  fontFamily: 'Times',
  fontSize: 15
});
EnglishLang.setColor('black');
EnglishLang.selectable = true;
EnglishLang.visible = false;
EnglishLang.hasControls = EnglishLang.hasBorders = false;
EnglishLang.lockMovementX = EnglishLang.lockMovementY = true;
ArrayOfObjects.push(EnglishLang);

//+++++

var SpanishLang = new fabric.Text('Español', {
  left: 180,
  top: 380,
  fontFamily: 'Times',
  fontSize: 15
});
SpanishLang.setColor('black');
SpanishLang.selectable = true;
SpanishLang.visible = false;
SpanishLang.hasControls = SpanishLang.hasBorders = false;
SpanishLang.lockMovementX = SpanishLang.lockMovementY = true;
ArrayOfObjects.push(SpanishLang);

//++++++

var ArabicLang = new fabric.Text('عربي', {
  left: 260,
  top: 380,
  fontFamily: 'Times',
  fontSize: 15
});
ArabicLang.setColor('black');
ArabicLang.selectable = true;
ArabicLang.visible = false;
ArabicLang.hasControls = ArabicLang.hasBorders = false;
ArabicLang.lockMovementX = ArabicLang.lockMovementY = true;
ArrayOfObjects.push(ArabicLang);

//++++++

var HindiLang = new fabric.Text('हिंदी', {
  left: 330,
  top: 380,
  fontFamily: 'Times',
  fontSize: 15
});
HindiLang.setColor('black');
HindiLang.selectable = true;
HindiLang.visible = false;
HindiLang.hasControls = HindiLang.hasBorders = false;
HindiLang.lockMovementX = HindiLang.lockMovementY = true;
ArrayOfObjects.push(HindiLang);

//++++++

var ChineseLang = new fabric.Text('中文', {
  left: 400,
  top: 380,
  fontFamily: 'Times',
  fontSize: 15
});
ChineseLang.setColor('black');
ChineseLang.selectable = true;
ChineseLang.visible = false;
ChineseLang.hasControls = ChineseLang.hasBorders = false;
ChineseLang.lockMovementX = ChineseLang.lockMovementY = true;
ArrayOfObjects.push(ChineseLang);

//++++++

var PersianLang = new fabric.Text('فارسی', {
  left: 100,
  top: 420,
  fontFamily: 'Times',
  fontSize: 15
});
PersianLang.setColor('black');
PersianLang.selectable = true;
PersianLang.visible = false;
PersianLang.hasControls = PersianLang.hasBorders = false;
PersianLang.lockMovementX = PersianLang.lockMovementY = true;
ArrayOfObjects.push(PersianLang);

//+++++

var RomanLang = new fabric.Text('hrvatski', {
  left: 180,
  top: 420,
  fontFamily: 'Times',
  fontSize: 15
});
RomanLang.setColor('black');
RomanLang.selectable = true;
RomanLang.visible = false;
RomanLang.hasControls = RomanLang.hasBorders = false;
RomanLang.lockMovementX = RomanLang.lockMovementY = true;
ArrayOfObjects.push(RomanLang);

//++++++

var RussianLang = new fabric.Text('русский', {
  left: 260,
  top: 420,
  fontFamily: 'Times',
  fontSize: 15
});
RussianLang.setColor('black');
RussianLang.selectable = true;
RussianLang.visible = false;
RussianLang.hasControls = RussianLang.hasBorders = false;
RussianLang.lockMovementX = RussianLang.lockMovementY = true;
ArrayOfObjects.push(RussianLang);

//++++++

var ItalianLang = new fabric.Text('italiano', {
  left: 330,
  top: 420,
  fontFamily: 'Times',
  fontSize: 15
});
ItalianLang.setColor('black');
ItalianLang.selectable = true;
ItalianLang.visible = false;
ItalianLang.hasControls = ItalianLang.hasBorders = false;
ItalianLang.lockMovementX = ItalianLang.lockMovementY = true;
ArrayOfObjects.push(ItalianLang);

//++++++

var SlovakLang = new fabric.Text('slovenský', {
  left: 400,
  top: 420,
  fontFamily: 'Times',
  fontSize: 15
});
SlovakLang.setColor('black');
SlovakLang.selectable = true;
SlovakLang.visible = false;
SlovakLang.hasControls = SlovakLang.hasBorders = false;
SlovakLang.lockMovementX = SlovakLang.lockMovementY = true;
ArrayOfObjects.push(SlovakLang);

var langpromptbox = new fabric.Rect({
  left: panelleft,
  top: paneltop,
  fill: '##f9f9f9',
  stroke: 'black',
  width: panelwidth,
  height: panelheight,
  angle: 0
});
langpromptbox.visible = false;
langpromptbox.hasControls = langpromptbox.hasBorders = langpromptbox.selectable = false;
langpromptbox.lockMovementX = langpromptbox.lockMovementY = true;


function FabricText(string,mLeft, mTop, mFontSize) {
  var temp = new fabric.Text(string, {
    left: mLeft,
    top: mTop,
    fontFamily: 'Times',
    fontSize: mFontSize
  });
  temp.visible = false;
  temp.hasControls = temp.hasBorders = temp.selectable = false;
  temp.lockMovementX = temp.lockMovementY = true;
  return temp;
}

var FailOrSuccess = FabricText(GREAT[syslang],247,360,24);
var FeedBackMessage = FabricText(NOWSET[syslang] + "English." , 155, 400, 17);
var ReturnMessage = FabricText(RETURNMSG[syslang],105, 440,15);

function ShowLangFeedBack(string, changed) {
  if(changed == true ) {
    console.log("CHANGED");
    if(syslang == SPANISH) {
      FailOrSuccess.setLeft = 237;
    }
    else {
      FailOrSuccess.setLeft = 247;
    }
    FailOrSuccess.text = GREAT[syslang];
    FeedBackMessage.text = NOWSET[syslang] + string + ".";
    ReturnMessage.text = RETURNMSG[syslang];
  }
  else {
    console.log("DID NOT CHANGE");
    FailOrSuccess.text = SORRY[syslang];
    FeedBackMessage.text = NOTSET[syslang] + string + ".";
  }
  langpromptbox.visible = true;
  ReturnMessage.visible = true;
  FeedBackMessage.visible = true;
  FailOrSuccess.visible = true;
}

function HideLangFeedBack() {
  langpromptbox.visible = false;
  ReturnMessage.visible = false;
  FeedBackMessage.visible = false;
  FailOrSuccess.visible = false;
}


////++++++
//var SaveLangButton = new fabric.Text('  Save Language  ', {
//  left: 220,
//  top: 470,
//  backgroundColor: '#B3B4B4',
//  fontFamily: 'Times',
//  fontWeight: 'bold',
//  fontSize: 15
//});
//SaveLangButton.setColor('black');
//SaveLangButton.selectable = true;
//SaveLangButton.visible = false;
//SaveLangButton.hasControls = SaveLangButton.hasBorders = false;
//SaveLangButton.lockMovementX = SaveLangButton.lockMovementY = true;
//ArrayOfObjects.push(SaveLangButton);

//-------------------- Components for date time format----------------------------------
//++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
var DateTimePanel = new fabric.Rect({
  left: 72,
  top: 310,
  fill: 'lightgrey',
  //stroke: 'darkgrey',
  width: 410,
  height: 200,
  angle: 0
});
DateTimePanel.visible = false;
DateTimePanel.hasControls = DateTimePanel.hasBorders = DateTimePanel.selectable = false;
DateTimePanel.lockMovementX = DateTimePanel.lockMovementY = true;

fabric.util.loadImage('images/DateTimeBackground.jpg', function (img) {
  DateTimePanel.setPatternFill({
    source: img,
    repeat: 'repeat'
  });
});

ArrayOfObjects.push(DateTimePanel);
//++++++++++++++++

var DateFormatText = new fabric.Text(' Date Format  ', {
  left: 150,
  top: 320,
  fontFamily: 'Times',
  fontWeight: 'bold',
  fontSize: 15
});
DateFormatText.setColor('black');
DateFormatText.selectable = true;
DateFormatText.visible = false;
DateFormatText.hasControls = DateFormatText.hasBorders = false;
DateFormatText.lockMovementX = DateFormatText.lockMovementY = true;
ArrayOfObjects.push(DateFormatText);

//+++++++

var TimeFormatText = new fabric.Text(' Date Format  ', {
  left: 300,
  top: 320,
  fontFamily: 'Times',
  fontWeight: 'bold',
  fontSize: 15
});
TimeFormatText.setColor('black');
TimeFormatText.selectable = true;
TimeFormatText.visible = false;
TimeFormatText.hasControls = TimeFormatText.hasBorders = false;
TimeFormatText.lockMovementX = TimeFormatText.lockMovementY = true;
ArrayOfObjects.push(TimeFormatText);

//+++++++
var DateFormat1 = new fabric.Text('  Month DD, YYYY  ', {
  left: 150,
  top: 350,
  backgroundColor: 'silver',
  fontFamily: 'Times',
  fontSize: 15
});
DateFormat1.setColor('black');
DateFormat1.selectable = true;
DateFormat1.visible = false;
DateFormat1.hasControls = DateFormat1.hasBorders = false;
DateFormat1.lockMovementX = DateFormat1.lockMovementY = true;
ArrayOfObjects.push(DateFormat1);

//++++++++
var DateFormat2 = new fabric.Text('  MM/DD/YYYY       ', {
  left: 150,
  top: 380,
  backgroundColor: 'silver',
  fontFamily: 'Times',
  fontSize: 15
});
DateFormat2.setColor('black');
DateFormat2.selectable = true;
DateFormat2.visible = false;
DateFormat2.hasControls = DateFormat2.hasBorders = false;
DateFormat2.lockMovementX = DateFormat2.lockMovementY = true;
ArrayOfObjects.push(DateFormat2);

//+++++++
var DateFormat3 = new fabric.Text('  DD Month YYYY   ', {
  left: 150,
  top: 410,
  backgroundColor: 'silver',
  fontFamily: 'Times',
  fontSize: 15
});
DateFormat3.setColor('black');
DateFormat3.selectable = true;
DateFormat3.visible = false;
DateFormat3.hasControls = DateFormat3.hasBorders = false;
DateFormat3.lockMovementX = DateFormat3.lockMovementY = true;
ArrayOfObjects.push(DateFormat3);

//+++++++

var DateFormat4 = new fabric.Text('  DD/MM/YYYY       ', {
  left: 150,
  top: 440,
  backgroundColor: 'silver',
  fontFamily: 'Times',
  fontSize: 15
});
DateFormat4.setColor('black');
DateFormat4.selectable = true;
DateFormat4.visible = false;
DateFormat4.hasControls = DateFormat4.hasBorders = false;
DateFormat4.lockMovementX = DateFormat4.lockMovementY = true;
ArrayOfObjects.push(DateFormat4);

//+++++++

var TimeFormat1 = new fabric.Text('  12 Hour Format  ', {
  left: 300,
  top: 350,
  backgroundColor: 'silver',
  fontFamily: 'Times',
  fontSize: 15
});
TimeFormat1.setColor('black');
TimeFormat1.selectable = true;
TimeFormat1.visible = false;
TimeFormat1.hasControls = TimeFormat1.hasBorders = false;
TimeFormat1.lockMovementX = TimeFormat1.lockMovementY = true;
ArrayOfObjects.push(TimeFormat1);

//++++++++

var TimeFormat2 = new fabric.Text('  24 Hour Format  ', {
  left: 300,
  top: 380,
  backgroundColor: 'silver',
  fontFamily: 'Times',
  fontSize: 15
});
TimeFormat2.setColor('black');
TimeFormat2.selectable = true;
TimeFormat2.visible = false;
TimeFormat2.hasControls = TimeFormat2.hasBorders = false;
TimeFormat2.lockMovementX = TimeFormat2.lockMovementY = true;
ArrayOfObjects.push(TimeFormat2);

//+++++++++

var SaveDateTimeFormatButton = new fabric.Text('  Save Format  ', {
  left: 220,
  top: 475,
  backgroundColor: '#B3B4B4',
  fontFamily: 'Times',
  fontWeight: 'bold',
  fontSize: 15
});
SaveDateTimeFormatButton.setColor('black');
SaveDateTimeFormatButton.selectable = true;
SaveDateTimeFormatButton.visible = false;
SaveDateTimeFormatButton.hasControls = SaveDateTimeFormatButton.hasBorders = false;
SaveDateTimeFormatButton.lockMovementX = SaveDateTimeFormatButton.lockMovementY = true;
ArrayOfObjects.push(SaveDateTimeFormatButton);

var LanguageArr = []
LanguageArr.push(EnglishLang);
LanguageArr.push(SpanishLang);
LanguageArr.push(ArabicLang);
LanguageArr.push(HindiLang);
LanguageArr.push(ChineseLang);
LanguageArr.push(PersianLang);
LanguageArr.push(ItalianLang);
LanguageArr.push(RomanLang);
LanguageArr.push(RussianLang);
LanguageArr.push(SlovakLang);
// ----------------- Some hide functions -----------------------------------------------

function ShowLanguageSetting(){
    mBackButton.addToBackStack(showSettings,HideLangaugeSetting);
    HideHome();
    LangaugePanel.visible = true;
    if(syslang == ENGLISH) {
      EnglishLang.fontWeight = "bold";
      SpanishLang.fontWeight  = "normal";
    }
    else {
      SpanishLang.fontWeight  = "bold";
      EnglishLang.fontWeight  = "normal";
    }
    EnglishLang.visible = true;
    SpanishLang.visible = true;
    ArabicLang.visible = true;
    HindiLang.visible = true;
    ChineseLang.visible = true;
    PersianLang.visible = true;
    ItalianLang.visible = true;
    RomanLang.visible = true;
    RussianLang.visible = true;
    SlovakLang.visible = true;
    //SaveLangButton.visible = true;
}

function HideLangaugeSetting(){
    //ShowHome();
    LangaugePanel.visible = false;
    EnglishLang.visible = false;
    SpanishLang.visible = false;
    ArabicLang.visible = false;
    HindiLang.visible = false;
    ChineseLang.visible = false;
    PersianLang.visible = false;
    ItalianLang.visible = false;
    RomanLang.visible = false;
    RussianLang.visible = false;
    SlovakLang.visible = false;
    //SaveLangButton.visible = false;
}
//--------------------------------------------------------------------------------------
// add all of the elements to the canvas

canvas.add(insideDoor);
canvas.add(outsideDoor);
canvas.add(date_rect);
canvas.add(MessageBox);
canvas.add(MessagesDroplist);
canvas.add(PublicText);
canvas.add(PrivateText);
canvas.add(MessageHelloOutside);
canvas.add(Mirror);
canvas.add(Traffic);
canvas.add(Transport);
canvas.add(News);
canvas.add(Weathertext);
canvas.add(Deadbolttext);
canvas.add(Line);
canvas.add(PanelRect);
canvas.add(Messagestext);
canvas.add(Cameratext);
canvas.add(Traffictext);
canvas.add(Transporttext);
canvas.add(Newstext);
canvas.add(Mirrortext);
canvas.add(Lightstext);
canvas.add(Alarmtext);
canvas.add(Emergtext);
canvas.add(Settingstext);

canvas.add(Lights);
canvas.add(AvatarOut);
canvas.add(CameraIn);
canvas.add(AvatarOnOff);
canvas.add(LiveOnOff);


canvas.add(UsersText);
canvas.add(LanguageText);
canvas.add(TrafficText);
canvas.add(DatetimeText);
canvas.add(DoorbellText);
canvas.add(UnitsText);
canvas.add(BrightnessText);
canvas.add(VolumeText);
canvas.add(ThemesText);
canvas.add(IntercomText);
canvas.add(UserPanel);
canvas.add(sendKey);
canvas.add(input_sendKey);
canvas.add(post_sendKey);
canvas.add(traffic_option_work);
canvas.add(traffic_option_barber);
canvas.add(traffic_option_moms);
canvas.add(traffic_add_btn);
canvas.add(traffic_save_btn);
canvas.add(traffic_input_name);
canvas.add(traffic_input_name_text);
canvas.add(traffic_input_address);
canvas.add(traffic_input_address_text);
canvas.add(traffic_add_btn_text);
canvas.add(traffic_save_btn_text);
canvas.add(traffic_star2);
canvas.add(traffic_star1);

canvas.add(brightness_text);
canvas.add(slider_back);
canvas.add(slider);
canvas.add(display_text);
canvas.add(one_min_btn);
canvas.add(one_min_btn_text);
canvas.add(three_min_btn);
canvas.add(three_min_btn_text);
canvas.add(five_min_btn);
canvas.add(five_min_btn_text);

canvas.add(doorbell_cancel_btn)
canvas.add(doorbell_cancel_btn_text);
canvas.add(doorbell_save_btn);
canvas.add(doorbell_save_btn_text);
canvas.add(doorbell_mute_option);
canvas.add(doorbell_mute_option_text);
canvas.add(doorbell_ding_option);
canvas.add(doorbell_ding_option_text);
canvas.add(doorbell_dingdong_option);
canvas.add(doorbell_dingdong_option_text);

//For themes texts and components
canvas.add(InsideText);
canvas.add(OutsideText);
canvas.add(ThemesDroplist);
canvas.add(OrnamentDroplist);
canvas.add(WoodText);
canvas.add(MetalText);
canvas.add(XmassText);
canvas.add(EasterText);
canvas.add(ResetTheme);

canvas.add(volumepanel);
canvas.add(volumebar);
canvas.add(volumeslider);
canvas.add(VolumeSettingsText);
canvas.add(volumePercentage);

//Language settings comp

canvas.add(LangaugePanel);
canvas.add(EnglishLang);
canvas.add(SpanishLang);
canvas.add(ArabicLang);
canvas.add(HindiLang);
canvas.add(ChineseLang);
canvas.add(PersianLang);
canvas.add(ItalianLang);
canvas.add(RomanLang);
canvas.add(RussianLang);
canvas.add(SlovakLang);
//canvas.add(SaveLangButton);

// Date and time

canvas.add(DateTimePanel);
canvas.add(DateFormatText);
canvas.add(TimeFormatText);
canvas.add(DateFormat1);
canvas.add(DateFormat2);
canvas.add(DateFormat3);
canvas.add(DateFormat4);
canvas.add(TimeFormat1);
canvas.add(TimeFormat2);
canvas.add(SaveDateTimeFormatButton);

canvas.add(langpromptbox);
canvas.add(FailOrSuccess);
canvas.add(FeedBackMessage);
canvas.add(ReturnMessage);


canvas.add(VideoPanel);
canvas.add(video1);
//************************************** Functions *******************************************


  
canvas.on({ 'object:selected': function(e) {
    var activeObject = e.target;
    console.log(activeObject);
    //console.log(e.target);
    if(activeObject.id == 'home'){
      HomeSelected();
      HideLangFeedBack();
      HideVolumeSettings()

      canvas.deactivateAll();
      if(CURRENT_USER != null)
        CURRENT_USER.hideObjects();
    }
    else if(activeObject.id == 'LockKnobIn')
      UnlockDoorIn();

    else if(activeObject.id == 'UnlockKnobIn')
      LockDoorIn();

    else if(activeObject.id == 'LockKnobOut') {
      if(UserFingerIsRecognizable == true)
      UnlockDoorOut();
    }

    else if(activeObject.id == 'UnlockKnobOut')
      LockDoorOut();
    else if(activeObject.id == 'LockDeadbolt')
       UnlockDeadbolt();
    else if(activeObject.id == 'UnlockDeadbolt')
       LockDeadbolt();

    else if(activeObject.id == 'restart')
       RestartSystem();

    else if(activeObject.id == 'alarmOn')
       AlarmOff();

    else if(activeObject.id == 'alarm')
        AlarmOn();

    else if(activeObject.id == 'user1name'){
        HideUsersList();
        User1FromInside();
    }
    else if(activeObject.id == 'user2name'){
      HideUsersList();
      User2FromInside();
    }
    else if (activeObject.id == "doorbell")
      playDoorbellSound();
    else if (activeObject.id == "settings") {
      showSettings();
      mBackButton.addToBackStack( HomeSelected,hideSettings);
      //canvas.deactivateAll();
    }
    else if(activeObject.id == 'settings_units') {

    }
    else if (activeObject.id == "settings_traffic") {
      showTrafficSettings();
      hideSettings();
      mBackButton.addToBackStack(showSettings, hideTrafficSettings);
    }
    else if (activeObject.id == "traffic_add_btn" || activeObject.id == "traffic_add_btn_text")
      showTrafficInputAdd();

    else if(activeObject.id == "traffic_star1" || activeObject.id == "traffic_star2")
      toggleTrafficPrimary(activeObject.id);

    else if (activeObject.id == "settings_themes"){
      hideSettings();
      ShowThemeSettings();
      mBackButton.addToBackStack(showSettings,CloseThemeSettings);
    }
    else if (activeObject.id == "settings_brightness") {
      showBrightnessSettings();
      hideSettings();
      mBackButton.addToBackStack(showSettings, hideBrightnessSettings);
    }
    else if (activeObject.id == "five_min_btn" || activeObject.id == "five_min_btn_text")
      updateDisplayTimer("five");
    else if (activeObject.id == "one_min_btn" || activeObject.id == "one_min_btn_text")
      updateDisplayTimer("one");
    else if (activeObject.id == "three_min_btn" || activeObject.id == "three_min_btn_text")
      updateDisplayTimer("three");
    else if (activeObject.id == "brightness_save_btn" || activeObject.id == "brightness_save_btn_text"){
      hideBrightnessSettings(true);
      showSettings();
    }

    else if (activeObject.id == "settings_doorbell") {
      showDoorbellSettings();
      hideSettings();
      mBackButton.addToBackStack(showSettings, hideDoorbellSettings);
    }
    else if (activeObject.id == "doorbell_dingdong_option" || activeObject.id == "doorbell_dingdong_option_text")
      toggle_doobell_option("ding-dong");
    else if (activeObject.id == "doorbell_ding_option" || activeObject.id == "doorbell_ding_option_text")
      toggle_doobell_option("ding");
    else if (activeObject.id == "doorbell_mute_option" || activeObject.id == "doorbell_mute_option_text")
      toggle_doobell_option("mute");
    else if (activeObject.id == "doorbell_cancel_btn" || activeObject.id == "doorbell_cancel_btn_text") {
      hideDoorbellSettings(false);
      showSettings();
    }
    else if (activeObject.id == "doorbell_save_btn" || activeObject.id == "doorbell_save_btn_text") {
      CURRENT_USER.doorbell_pref = DoorbellAudio;
      hideDoorbellSettings(true);
      showSettings();
    }

    else if(activeObject.id == 'messages'){
      ShowMessageSettings();
      //MessageBoxSelected();
      canvas.deactivateAll();
    }
    else if(activeObject.id == 'messageBox'){
      HomeSelected();
      canvas.deactivateAll();
    }
    else if(activeObject.id == 'accept'){
      AcceptSelected();
      canvas.deactivateAll();
    }
    else if( -1 < activeObject.id && activeObject.id < 11) {
      for(var i=0; i < 11; i ++ ){
        if (activeObject.id == i){
          ShowUserData(i);
          break;
        }
      }
    }
    else if(activeObject.id == 'mirror'){
        MirrorSelected();
        canvas.deactivateAll();
    }
    else if(activeObject.id == 'traffic'){
      TrafficSelected();
      canvas.deactivateAll();
    }
    else if(activeObject.id == 'lights'){
      LightsSelected();
      canvas.deactivateAll();
    }
    else if(activeObject.id == 'cta'){
      TransportSelected();
      canvas.deactivateAll();
    }
    else if(activeObject.id == 'news'){
      NewsSelected();
      canvas.deactivateAll();
    }
    else if(activeObject.id == 'camera'){
      RunCamera();
      //canvas.deactivateAll();
    }
    else if(activeObject.id == "settings_users"){
      hideSettings();
      ShowUserSettings();
    }
    else if(activeObject.id == 'settings_volume'){
      ShowVolumeSettings();
      mBackButton.addToBackStack( showSettings, HideVolumeSettings);
    }
    else if(activeObject.id == 'backbutton'){
      checkSettings();
      mBackButton.goBack();
    }
    else if(activeObject.id == '911'){
      HideHome();
      Show911();

    }
    else if(activeObject.id == 'CancelEmergency'){
      Hide911();
      ShowHome();
    }

    else if(activeObject.id == 'CancelEmergency2'){
      Hide911();
      ShowHome();
    }
    else if(activeObject.id == 'YesEmergency'){
      Hide911();
      Run911Call();
    }

    else if(activeObject.id == 'numberpad') {
      NumberPadEvent();
    }
    else if(activeObject.id == 'settings_language') {
      ShowLanguageSetting();
      LanguageSettingIsActive = true;
    }

    if( (langselected = isLangSelected(activeObject)) != null ){
        console.log("langselected: " + langselected);
        SaveLanguageSettings(langselected);
    }
    else if(activeObject.id == 'settings_intercom') {
      ShowVideoTour();
    }

    else if(activeObject.id == 'play') {
      play();
    }

    else if(activeObject.id == 'pause') {
      pause();
    }

    canvas.deactivateAll();
  }
});

AvatarOnOff.on('selected', function(){
  if (AvatarIsActive == true)
    RunInsideCameraLive();
  else
    RunInsideCameraAvatar();
});

LiveOnOff.on('selected', function(){
  if (AvatarIsActive == true)
    RunInsideCameraLive();
  else
    RunInsideCameraAvatar();
});


//CancelEmergency.on('selected', function()
// {

// });
//********************************************************************************************


// code adapted from http://jsfiddle.net/tornado1979/39up3jcm/
// this code deals with scaling all the elements on the canvas

function zoomAll(SCALE_FACTOR) {
  var objects = canvas.getObjects();
  for (var i in objects) {
    var scaleX = objects[i].scaleX;
    var scaleY = objects[i].scaleY;
    var left = objects[i].left;
    var top = objects[i].top;

    var tempScaleX = scaleX * SCALE_FACTOR;
    var tempScaleY = scaleY * SCALE_FACTOR;
    var tempLeft = left * SCALE_FACTOR;
    var tempTop = top * SCALE_FACTOR;

    objects[i].scaleX = tempScaleX;
    objects[i].scaleY = tempScaleY;
    objects[i].left = tempLeft;
    objects[i].top = tempTop;

    objects[i].setCoords();
  }
  canvas.renderAll();
}

// draw everything at the appropriate scale for this canvas
zoomAll(canvas.height / localHeight);

if(backbutton == null) {
  backbutton = getObjectWithId('backbutton');
}

//})();

</script>

</head>

</html>