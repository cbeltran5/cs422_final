<!-- template for Project 1 - CS 422 - Spring 2016 - Andrew Johnson -->

<!DOCTYPE html>  
<html>
<head>
    <meta charset="utf-8">
    <title>fabric.js project template</title>
    <script src="enrique.js"></script>
	
    <style>
code {
  background: #1D5F9A;
  border-radius: 6px;
  color: #fff;
  display: block;
  font: 44px/64px "Source Code Pro", Inconsolata, "Calibri", Terminal, "Calibri", Courier;
  padding: 24px 15px;
  text-align: left;
}
header,
section,
aside,
footer {
  margin: 1% 20px;
}
section {
  
  float: left;
  width: auto;
  height: auto;
}
aside {
  
  float: left;
  width: auto;
  height: auto;
}
footer {
  clear: both;
  margin-bottom: 0;
}

.radio1 {
    width: 40px;
    height: 40px;
    }

</style>
	<!-- Get version 1.5.0 of Fabric.js from CDN -->
	<script src="https://cdnjs.cloudflare.com/ajax/libs/fabric.js/1.5.0/fabric.min.js" ></script>
 

	 
<body>
		<!-- canvas tag for Fabric.js to draw into -->
    <!-- set this to some appropriate size for your development work -->
    <!-- but keep the same aspect ratio -->
    <!-- we will use width="2714" height="2200" for presentations and evaluation -->
		<!-- <canvas id="c" width="494" height="400" style="border:2px solid black;" ></canvas> -->
    <canvas id="c" width="2714" height="2200" style="border:2px solid black;" ></canvas>
    <section>
    <h1>Inside Events</h1>

    <code> 

      <section>
      <code><form>
      Users:<br>
      <input type="radio" class="radio1" name="UsersIn" onchange="User1FromInside()" value="Adam"> Adam<br>
      <input type="radio" class="radio1" name="UsersIn" onchange="User2FromInside()" value="Sara"> Sara<br>
      <input type="radio" class="radio1" name="UsersIn" onchange="MultiUsersFromInside()" value="MultiUser"> Multi Users<br>
      <input type="radio" class="radio1" name="UsersIn" onchange="NewUserFromInside()" value="NewUser"> New User<br>
      <input type="radio" class="radio1" name="UsersIn" onchange="NoUserFromInside()" value="NoSignal" checked> No Signal<br>

      </form></code>
      </section>

      <section>
      <code><form>
      Heights:<br>
      <input type="radio" class="radio1" name="Heights" onchange="TallHeight()" value="Tall"> Tall<br>
      <input type="radio" class="radio1" name="Heights" onchange="MediumHeight()" value="Medium"> Medium<br>
      <input type="radio" class="radio1" name="Heights" onchange="ShortHeight()" value="Short"> Short<br>
      </form></code> 
      </section>

<section></section><section></section>
<section></section><section></section>
<section></section><section></section>
<section></section><section></section>
<section></section><section></section>
<section></section><section></section>
<section></section><section></section>
<section></section><section></section>
<section></section><section></section>


      </code>


    </section>

    <section>
    <h1>Outside Events</h1>

    <code> 


      <section>
      <code><form>
      Users:<br>
      <input type="radio" class="radio1" name="UsersOut" onchange="User1FromOutside()" value="Adam"> Adam<br>
      <input type="radio" class="radio1" name="UsersOut" onchange="NewUserFromOutside()" value="NewUser"> New User<br>
      <input type="radio" class="radio1" name="UsersOut" onchange="NoUserFromOutside()" value="NoSignal" checked> No Signal<br>

      </form></code>
      </section>

      <section>
      <code><form>
      Verification:<br>
      <input type="radio" class="radio1" name="Verification" onchange="FaceRecognized()" value="Face"> Face<br>
      <input type="radio" class="radio1" name="Verification" onchange="FingerRecognized()" value="FingerPrint"> FingerPrint<br>
      <input type="radio" class="radio1" name="Verification" onchange="FailedVerification()" value="None" checked> None<br>
      </form></code> 
      </section>


      </code>

    </section>
</body>
 

<script>

// the aspect ratios given here are not quite tall enough for a 36" x 80" door
// we are assuming bottom 15 inches of the door are not part of the display. 
// that part contains lots of necessary electronics so the bottom of the door
// sits off the bottom of our display wall. You are implementing the interface
// for the top 65" of the display / door

//(function() {

// within the code below I assume I am drawing into a 1220x990 box
// then I can scale the group to whatever size the final canvas is
  var localHeight = 990;
  var localWidth = 1220;

  //var checkedRB = $('input[type="radio"][name="layout"]:checked');

  var canvas = this.__canvas = new fabric.Canvas('c');

  // set background to blue to make it easier to see it
  canvas.backgroundColor = "#DDDDDD";  // light grey

//****************************** System Settings Parameters *********************************

var System_language = 'English';

var In_theme = 'default';
var In_ornament = 'default';
var Out_theme = 'default';
var Out_ornament = 'default';

var Date_format = 1;
var Time_format = 1;
var Units_format = 'Imperial';

var HomeIsActive = false;
var Current_user = null; 
var RestartIsActive = false;
//*******************************************************************************************

//************************************ Users Profiles ***************************************
var User1 = {
  name : 'Adam',
  language : 'English',

  in_theme : 'wood',
  out_theme : 'wood',
  in_ornament : 'default',
  out_ornament : 'default',

  date_format : 1,
  time_format : 1,
  units_format : 'Imperial'

};

var User2 = {
  name : 'Sara',
  language : 'English',

  in_theme : 'metal',
  out_theme : 'metal',
  in_ornament : 'default',
  out_ornament : 'default',

  date_format : 1,
  time_format : 1,
  units_format : 'Imperial'

};
//*******************************************************************************************


// need 36 wide instead of 40 as now
//*************************** Inside & Outside door initialization **************************

var insideDoor = new fabric.Rect({
  left: 22,
  top: 0,
  fill: 'grey',
  stroke: 'black',
  width: 555,
  height: localHeight,
  angle: 0
});

// the doors will not be selectable or movable
insideDoor.hasControls = insideDoor.hasBorders = insideDoor.selectable = false;
insideDoor.lockMovementX = insideDoor.lockMovementY = true;
// Default door pattern
fabric.util.loadImage('images/Doorpattern.gif', function (img) {
    insideDoor.setPatternFill({
        source: img,
        repeat: 'repeat'
    });
    canvas.renderAll();
});

var outsideDoor = new fabric.Rect({
  left: 642,
  top: 0,
  fill: 'grey',
  stroke: 'black',
  width: 555,
  height: localHeight,
  angle: 0
});

outsideDoor.hasControls = outsideDoor.hasBorders = outsideDoor.selectable = false;
outsideDoor.lockMovementX = outsideDoor.lockMovementY = true;
// Default door pattern
fabric.util.loadImage('images/Doorpattern.gif', function (img) {
    outsideDoor.setPatternFill({
        source: img,
        repeat: 'repeat'
    });
    canvas.renderAll();
});
//*******************************************************************************************


//******************************* Adding Date/Time and weather ******************************

var Datetext = new fabric.Text('', { left: 105, top: 112, fontFamily: 'Calibri', fontSize: 20 });
Datetext.setColor('black');
Datetext.selectable = false;

var rect = new fabric.Rect({
  left: 85,
  top: 110,
  fill: 'lightgrey',
  stroke: 'darkgrey',
  width: 150,
  height: 25,
  angle: 0
});
rect.selectable = false;

var Timetext = new fabric.Text('', { left: 100, top: 80, fontFamily: 'Calibri', fontSize: 30 });
Timetext.setColor('black');
Timetext.selectable = false;

ShowDateTime();

fabric.Image.fromURL('images/weather.gif', function(oImg) {
  oImg.set({left: 800, top: 95, id: this.id});
  oImg.selectable = false;
  oImg.id = 'weather';
  canvas.add(oImg);
});

var Weathertext = new fabric.Text('49 F', { left: 475, top: 80, fontFamily: 'Calibri', fontSize: 30 });
Weathertext.setColor('black');
Weathertext.selectable = false;

//*******************************************************************************************


//******************************* Adding Home button ****************************************

fabric.Image.fromURL('images/home.gif', function(oImg) {
  oImg.set({left: 549, top: 555, id: this.id});
  oImg.id = 'home';
  oImg.hasControls = oImg.hasBorders = false;
  oImg.lockMovementY = oImg.lockMovementX = true;
  canvas.add(oImg);
});

var Line = new fabric.Line([100, 310, 460, 310], { lfill: 'black', stroke: 'black',strokeWidth: 0.5});
Line.selectable = false;

//********************************************************************************************

//******************************* Adding In/out Door knobs  ******************************************

fabric.Image.fromURL('images/lockknob.png', function(oImg) {
  oImg.set({left: 1120, top: 1030, id: this.id});
  oImg.id = 'LockKnobIn';
  oImg.hasControls = oImg.hasBorders = false;
  oImg.visible = true;
  oImg.lockMovementY = oImg.lockMovementX = true;
  canvas.add(oImg);
});

fabric.Image.fromURL('images/unlockknob.png', function(oImg) {
  oImg.set({left: 1120, top: 1030, id: this.id});
  oImg.id = 'UnlockKnobIn';
  oImg.hasControls = oImg.hasBorders = false;
  oImg.visible = false;
  oImg.lockMovementY = oImg.lockMovementX = true;
  canvas.add(oImg);
});

fabric.Image.fromURL('images/knob.png', function(oImg) {
  oImg.set({left: 1480, top: 1030, id: this.id});
  oImg.id = 'knob';
  oImg.hasControls = oImg.hasBorders = false;
  oImg.lockMovementY = oImg.lockMovementX = true;
  canvas.add(oImg);
});

fabric.Image.fromURL('images/lockdeadbolt.png', function(oImg) {
  oImg.set({left: 1100, top: 680, id: this.id});
  oImg.id = 'LockDeadbolt';
  oImg.hasControls = oImg.hasBorders = false;
  oImg.lockMovementY = oImg.lockMovementX = true;
  canvas.add(oImg);
});

fabric.Image.fromURL('images/unlockdeadbolt.png', function(oImg) {
  oImg.set({left: 1100, top: 680, id: this.id});
  oImg.id = 'UnlockDeadbolt';
  oImg.hasControls = oImg.hasBorders = false;
  oImg.visible = false;
  oImg.lockMovementY = oImg.lockMovementX = true;
  canvas.add(oImg);
});

var Deadbolttext = new fabric.Text('Deadbolt', { left: 500, top: 293, fontFamily: 'Calibri', fontSize: 15 });
Deadbolttext.setColor('black');
Deadbolttext.selectable = false;
//********************************************************************************************




//*********************** Components called by functions *************************************

//Main panel components
var PanelRect = new fabric.Rect({
  left: 72,
  top: 310,
  fill: 'lightgrey',
  stroke: 'darkgrey',
  width: 410,
  height: 200,
  angle: 0
});
  PanelRect.visible = false;
  PanelRect.hasControls = PanelRect.hasBorders = PanelRect.selectable = false;
  PanelRect.lockMovementX = PanelRect.lockMovementY = true;

  fabric.util.loadImage('images/panelpattern.gif', function (img) {
    PanelRect.setPatternFill({
        source: img,
        repeat: 'repeat'
    });
});

  fabric.Image.fromURL('images/messages.gif', function(oImg) {
  oImg.set({left: 189, top: 730, id: this.id});
  oImg.visible = false;
  oImg.hasControls = oImg.hasBorders = false;
  oImg.lockMovementY = oImg.lockMovementX = true;
  oImg.id = 'messages';
  canvas.add(oImg);
});

  var Messagestext = new fabric.Text('Messages', { left: 85, top: 385, fontFamily: 'Times', fontSize: 15 });
  Messagestext.setColor('black');
  Messagestext.selectable = false;
  Messagestext.visible = false;


fabric.Image.fromURL('images/camera.gif', function(oImg) {
  oImg.set({left: 369, top: 735, id: this.id});
  oImg.visible = false;
  oImg.hasControls = oImg.hasBorders = false;
  oImg.lockMovementY = oImg.lockMovementX = true;
  oImg.id = 'camera';
  canvas.add(oImg);
});

  var Cameratext = new fabric.Text('Camera', { left: 165, top: 385, fontFamily: 'Times', fontSize: 15 });
  Cameratext.setColor('black');
  Cameratext.selectable = false;
  Cameratext.visible = false;


fabric.Image.fromURL('images/traffic.gif', function(oImg) {
  oImg.set({left: 549, top: 720, id: this.id});
  oImg.visible = false;
  oImg.hasControls = oImg.hasBorders = false;
  oImg.lockMovementY = oImg.lockMovementX = true;
  oImg.id = 'traffic';
  canvas.add(oImg);
});

  var Traffictext = new fabric.Text('Traffic', { left: 255, top: 385, fontFamily: 'Times', fontSize: 15 });
  Traffictext.setColor('black');
  Traffictext.selectable = false;
  Traffictext.visible = false;


fabric.Image.fromURL('images/cta.gif', function(oImg) {
  oImg.set({left: 729, top: 720, id: this.id});
  oImg.visible = false;
  oImg.hasControls = oImg.hasBorders = false;
  oImg.lockMovementY = oImg.lockMovementX = true;
  oImg.id = 'cta';
  canvas.add(oImg);
});

  var Ctatext = new fabric.Text('Transport', { left: 330, top: 385, fontFamily: 'Times', fontSize: 15 });
  Ctatext.setColor('black');
  Ctatext.selectable = false;
  Ctatext.visible = false;

fabric.Image.fromURL('images/news.gif', function(oImg) {
  oImg.set({left: 909, top: 730, id: this.id});
  oImg.visible = false;
  oImg.hasControls = oImg.hasBorders = false;
  oImg.lockMovementY = oImg.lockMovementX = true;
  oImg.id = 'news';
  canvas.add(oImg);
});

  var Newstext = new fabric.Text('News', { left: 420, top: 385, fontFamily: 'Times', fontSize: 15 });
  Newstext.setColor('black');
  Newstext.selectable = false;
  Newstext.visible = false;

fabric.Image.fromURL('images/mirror.gif', function(oImg) {
  oImg.set({left: 189, top: 925, id: this.id});
  oImg.visible = false;
  oImg.hasControls = oImg.hasBorders = false;
  oImg.lockMovementY = oImg.lockMovementX = true;
  oImg.id = 'mirror';
  canvas.add(oImg);
});

  var Mirrortext = new fabric.Text('Mirror', { left: 95, top: 475, fontFamily: 'Times', fontSize: 15 });
  Mirrortext.setColor('black');
  Mirrortext.selectable = false;
  Mirrortext.visible = false;

fabric.Image.fromURL('images/lights.gif', function(oImg) {
  oImg.set({left: 369, top: 920, id: this.id});
  oImg.visible = false;
  oImg.hasControls = oImg.hasBorders = false;
  oImg.lockMovementY = oImg.lockMovementX = true;
  oImg.id = 'lights';
  canvas.add(oImg);
});

  var Lightstext = new fabric.Text('Lights', { left: 175, top: 475, fontFamily: 'Times', fontSize: 15 });
  Lightstext.setColor('black');
  Lightstext.selectable = false;
  Lightstext.visible = false;

fabric.Image.fromURL('images/alarm.gif', function(oImg) {
  oImg.set({left: 549, top: 920, id: this.id});
  oImg.visible = false;
  oImg.hasControls = oImg.hasBorders = false;
  oImg.lockMovementY = oImg.lockMovementX = true;
  oImg.id = 'alarm';
  canvas.add(oImg);
});

  var Alarmtext = new fabric.Text('Alarm', { left: 255, top: 475, fontFamily: 'Times', fontSize: 15 });
  Alarmtext.setColor('black');
  Alarmtext.selectable = false;
  Alarmtext.visible = false;


fabric.Image.fromURL('images/911.gif', function(oImg) {
  oImg.set({left: 729, top: 935, id: this.id});
  oImg.visible = false;
  oImg.hasControls = oImg.hasBorders = false;
  oImg.lockMovementY = oImg.lockMovementX = true;
  oImg.id = '911';
  canvas.add(oImg);
});

  var Emergtext = new fabric.Text('Emergency', { left: 325, top: 475, fontFamily: 'Times', fontSize: 15 });
  Emergtext.setColor('black');
  Emergtext.selectable = false;
  Emergtext.visible = false;

fabric.Image.fromURL('images/settings.gif', function(oImg) {
  oImg.set({left: 909, top: 930, id: this.id});
  oImg.visible = false;
  oImg.hasControls = oImg.hasBorders = false;
  oImg.lockMovementY = oImg.lockMovementX = true;
  oImg.id = 'settings';
  canvas.add(oImg);
});

  var Settingstext = new fabric.Text('Settings', { left: 415, top: 475, fontFamily: 'Times', fontSize: 15 });
  Settingstext.setColor('black');
  Settingstext.selectable = false;
  Settingstext.visible = false;

fabric.Image.fromURL('images/restart.png', function(oImg) {
  oImg.set({left: 550, top: 1150, id: this.id});
  oImg.visible = false;
  oImg.hasControls = oImg.hasBorders = false;
  oImg.lockMovementY = oImg.lockMovementX = true;
  oImg.id = 'restart';
  canvas.add(oImg);
});
//********************************************************************************************

// add all of the elements to the canvas

canvas.add(insideDoor);
canvas.add(outsideDoor);
canvas.add(rect);
canvas.add(Weathertext);
canvas.add(Deadbolttext);
canvas.add(Line);
canvas.add(PanelRect);
canvas.add(Messagestext);
canvas.add(Cameratext);
canvas.add(Traffictext);
canvas.add(Ctatext);
canvas.add(Newstext);
canvas.add(Mirrortext);
canvas.add(Lightstext);
canvas.add(Alarmtext);
canvas.add(Emergtext);
canvas.add(Settingstext);


//************************************** Functions *******************************************
canvas.on('object:selected', function(e) 
  { 
    var activeObject = e.target; 

    console.log(e.target);
    if(activeObject.id == 'home')
    {
      HomeSelected();
      canvas.deactivateAll();  
    }
    else if(activeObject.id == 'LockKnobIn')
      UnlockDoorIn();

   else if(activeObject.id == 'UnlockKnobIn')
      LockDoorIn();

   //else if(activeObject.id == 'LockKnobOut')
      //UnlockDoorOut();

   //else if(activeObject.id == 'UnlockKnobOut')
      //LockDoorOut();

   else if(activeObject.id == 'LockDeadbolt')
       UnlockDeadbolt();

   else if(activeObject.id == 'UnlockDeadbolt')
       LockDeadbolt();
    else if(activeObject.id == 'restart')
       RestartSystem();
   
  });


function ShowDateTime()
{
var currentdate = new Date();
var year = currentdate.getFullYear();
var month = currentdate.getMonth()+1;
var day = currentdate.getDate();
var hours = currentdate.getHours();
var minutes = currentdate.getMinutes();
var timetype;


if( hours >= 12)
   timetype = "PM";
else
   timetype = "AM";

if (Time_format == 1) // 12-hours format
{
hours = hours % 12;

if (hours == 0)
hours = 12;

if (minutes < 10)
minutes = "0" + minutes;

var time =  hours + ":" + minutes + " "+ timetype;
}

else if(Time_format == 2) // 24-hours format
{

if (hours < 10)
hours = "0" + hours;
if (minutes < 10)
minutes = "0" + minutes;

var time =  '    ' + hours + ":" + minutes;
}

if (Date_format == 1)
{
  if      (month == 1) month = 'January';
  else if (month == 2) month = 'February';
  else if (month == 3) month = 'March';
  else if (month == 4) month = 'April';
  else if (month == 5) month = 'May';
  else if (month == 6) month = 'June';
  else if (month == 7) month = 'July';
  else if (month == 8) month = 'August';
  else if (month == 9) month = 'September';
  else if (month == 10) month = 'October';
  else if (month == 11) month = 'November';
  else if (month == 12) month = 'December';
  var date = day + " " + month + "-" + year;
}

else if (Date_format == 2)
var date = ' ' + day + " - " + month + " - " + year;

Datetext.initialize(date);
canvas.remove(Datetext);
canvas.add(Datetext);

Timetext.initialize(time);
canvas.remove(Timetext);
canvas.add(Timetext);
timeout = setTimeout(ShowDateTime,1000);

}
//-------------------------------------------------------------
function HomeSelected()
{
  
  if (HomeIsActive == true)
    HideHome();
  else if(HomeIsActive == false)
    ShowHome();
}

function ShowHome()
{
  //console.log(HomeIsActive);
  HomeIsActive = true; 
  PanelRect.visible = true;

for (var i = 0; i < canvas.getObjects().length; ++i) 
  { 
    if (canvas.item(i).id == 'messages' || canvas.item(i).id == 'camera'   ||
        canvas.item(i).id == 'traffic'  || canvas.item(i).id == 'cta'      ||
        canvas.item(i).id == 'news'     || canvas.item(i).id == 'mirror'   ||
        canvas.item(i).id == 'lights'   || canvas.item(i).id == 'alarm'    ||
        canvas.item(i).id == '911'      || canvas.item(i).id == 'settings' ||
        canvas.item(i).id == 'restart' ) 
    {
      canvas.item(i).visible = true;
    }
    
  }

Messagestext.visible = true;
Cameratext.visible = true;
Traffictext.visible = true;
Ctatext.visible = true;
Newstext.visible = true;
Mirrortext.visible = true;
Lightstext.visible = true;
Alarmtext.visible = true;
Emergtext.visible = true;
Settingstext.visible = true;

}
//-------------------------------------------------------------
function HideHome()
{
  //console.log(HomeIsActive);
  HomeIsActive = false; 
  
  PanelRect.visible = false;

  for (var i = 0; i < canvas.getObjects().length; ++i) 
  { 
    if (canvas.item(i).id == 'messages' || canvas.item(i).id == 'camera'   ||
        canvas.item(i).id == 'traffic'  || canvas.item(i).id == 'cta'      ||
        canvas.item(i).id == 'news'     || canvas.item(i).id == 'mirror'   ||
        canvas.item(i).id == 'lights'   || canvas.item(i).id == 'alarm'    ||
        canvas.item(i).id == '911'      || canvas.item(i).id == 'settings' ||
        canvas.item(i).id == 'restart') 
    {
      canvas.item(i).visible = false;
    }
    
  }

Messagestext.visible = false;
Cameratext.visible = false;
Traffictext.visible = false;
Ctatext.visible = false;
Newstext.visible = false;
Mirrortext.visible = false;
Lightstext.visible = false;
Alarmtext.visible = false;
Emergtext.visible = false;
Settingstext.visible = false;

}
//-------------------------------------------------------------
 function UnlockDoorIn()
 {

  for (var i = 0; i < canvas.getObjects().length; ++i) 
  { 
    if (canvas.item(i).id == 'LockKnobIn')
    
      canvas.item(i).visible = false;
    
    else if (canvas.item(i).id == 'UnlockKnobIn')
      
      canvas.item(i).visible = true;
  }

 }
//-------------------------------------------------------------
function LockDoorIn()
 {

  for (var i = 0; i < canvas.getObjects().length; ++i) 
  { 
    if (canvas.item(i).id == 'UnlockKnobIn')
    
      canvas.item(i).visible = false;
    
    else if (canvas.item(i).id == 'LockKnobIn')
      
      canvas.item(i).visible = true;
  }

 }
//-------------------------------------------------------------
function UnlockDeadbolt()
 {

  for (var i = 0; i < canvas.getObjects().length; ++i) 
  { 
    if (canvas.item(i).id == 'LockDeadbolt')
    
      canvas.item(i).visible = false;
    
    else if (canvas.item(i).id == 'UnlockDeadbolt')
      
      canvas.item(i).visible = true;
  }

 }
//-------------------------------------------------------------
function LockDeadbolt()
 {

  for (var i = 0; i < canvas.getObjects().length; ++i) 
  { 
    if (canvas.item(i).id == 'UnlockDeadbolt')
    
      canvas.item(i).visible = false;
    
    else if (canvas.item(i).id == 'LockDeadbolt')
      
      canvas.item(i).visible = true;
  }

 }

//------------------ Radio buttons Events Functions -------------------------
function User1FromInside()
{

// To do list
// System settings adjusting

}

function User2FromInside()
{

// To do list
// System settings adjusting

}

function MultiUsersFromInside()
{

}

function NewUserFromInside()
{

}

function NoUserFromInside()
{
  HideHome();
  LockDoorIn();
  LockDeadbolt();
}

function TallHeight()
{

}

function MediumHeight()
{

}

function ShortHeight()
{

}

function User1FromOutside()
{

}

function NewUserFromOutside()
{

}

function NoUserFromOutside()
{

}

function FaceRecognized()
{

}

function FingerRecognized()
{

}

function FailedVerification()
{

}


//********************************************************************************************


// code adapted from http://jsfiddle.net/tornado1979/39up3jcm/
// this code deals with scaling all the elements on the canvas

function zoomAll(SCALE_FACTOR) {

      var objects = canvas.getObjects();
      for (var i in objects) {
          var scaleX = objects[i].scaleX;
          var scaleY = objects[i].scaleY;
          var left = objects[i].left;
          var top = objects[i].top;

          var tempScaleX = scaleX * SCALE_FACTOR;
          var tempScaleY = scaleY * SCALE_FACTOR;
          var tempLeft = left * SCALE_FACTOR;
          var tempTop = top * SCALE_FACTOR;

          objects[i].scaleX = tempScaleX;
          objects[i].scaleY = tempScaleY;
          objects[i].left = tempLeft;
          objects[i].top = tempTop;

          objects[i].setCoords();
      }
  
      canvas.renderAll();
  }

// draw everything at the appropriate scale for this canvas
zoomAll(canvas.height / localHeight);

//})();

</script>
		
</head>
  
</html>